<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Python 算法模版 | 星开祈灵的个人博客</title><meta name="keywords" content="Python,算法"><meta name="author" content="星开祈灵"><meta name="copyright" content="星开祈灵"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Python 算法模版"><meta name="application-name" content="Python 算法模版"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Python 算法模版"><meta property="og:url" content="https://kokoachino.github.io/2025/05/15/05%20Python%20%E7%AE%97%E6%B3%95%E6%A8%A1%E7%89%88/index.html"><meta property="og:site_name" content="星开祈灵的个人博客"><meta property="og:description" content="基础模版代码模版123456789101112131415161718192021222324252627# for _ in range(int(input())):#    n, a &amp;#x3D; int(input()), map(int, input().split())import sysi"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://gitee.com/kokoachino/picture-bed/raw/master/%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87.jpg?_r_=e447c906-a9f9-3635-350d-1367dda3555c"><meta property="article:author" content="星开祈灵"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://gitee.com/kokoachino/picture-bed/raw/master/%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87.jpg?_r_=e447c906-a9f9-3635-350d-1367dda3555c"><meta name="description" content="基础模版代码模版123456789101112131415161718192021222324252627# for _ in range(int(input())):#    n, a &amp;#x3D; int(input()), map(int, input().split())import sysi"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://kokoachino.github.io/2025/05/15/05%20Python%20%E7%AE%97%E6%B3%95%E6%A8%A1%E7%89%88/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: false,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":100,"languages":{"author":"作者: 星开祈灵","link":"链接: ","source":"来源: 星开祈灵的个人博客","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '星开祈灵的个人博客',
  title: 'Python 算法模版',
  postAI: '',
  pageFillDescription: '基础模版, 代码模版, 对拍模版, 经典模版, 回文子串, 回文数, 最长公共子序列, 最长递增子序列, 数组, 前缀和, 差分, 位运算枚举技巧, 单调栈, 单调队列, 字符串, 字符串哈希, KMP, Z 函数, 字典树, 图论, Dijkstra, Floyd, 拓扑排序, 并查集, 动态规划, 数位 DP, 矩阵快速幂, 数论, 质数筛选, 质因数分解, 乘法逆元, 高级数据结构, 树状数组 Sum, 树状数组 Min, 树状数组 Max, 线段树, 平衡树基础模版代码模版对拍模版对拍模版测试用例预期结果你的输出经典模版回文子串判断子串是否是回文的回文数返回所有位于内的回文数最长公共子序列最长公共子序列最长递增子序列最长递增子序列数组前缀和一维前缀积区间求积一维前缀和区间求和二维前缀和区域求和差分一维差分二维差分位运算枚举技巧返回按位或的结果集返回按位与的结果集单调栈上一个更小元素上一个更大元素下一个更小元素下一个更大元素单调队列滑动窗口最小值滑动窗口最大值字符串字符串哈希字符串哈希计算子字符串的哈希值主串目标串函数函数字典树字典树节点字典树插入单词查找前缀查找单词图论单源最短路堆优化的单源最短路全源最短路拓扑排序返回该有向无环图的拓扑排序并查集并查集查找元素所在集合的代表元素合并元素和所在的集合判断元素和是否属于同一集合查询元素所在集合的元素个数查询不同集合的个数动态规划数位数位通用模板矩阵快速幂矩阵乘法矩阵幂运算矩阵幂运算数论质数筛选埃氏筛质因数分解质因数分解乘法逆元返回所有位于的整数在模意义下的乘法逆元高级数据结构树状数组树状数组区间查询单点修改树状数组树状数组区间查询单点修改树状数组树状数组区间查询单点修改线段树线段树建树区间查询区间修改区间查询区间修改平衡树源码',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-06-27 15:33:39',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://gitee.com/kokoachino/picture-bed/raw/master/%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/head.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">星开祈灵的个人博客</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="http://8.138.214.176:5174/%E9%A1%B9%E7%9B%AE%E5%9B%BE%E5%BA%8A/%E6%98%9F%E5%BC%80%E7%A5%88%E7%81%B5%E7%99%BE%E5%AE%9D%E7%AE%B1%20%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3-29.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://8.138.214.176:5174/%E9%A1%B9%E7%9B%AE%E5%9B%BE%E5%BA%8A/%E6%98%9F%E5%BC%80%E7%A5%88%E7%81%B5%E7%99%BE%E5%AE%9D%E7%AE%B1%20%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3-29.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/API/" style="font-size: 1.05rem;">API<sup>1</sup></a><a href="/tags/CSS/" style="font-size: 1.05rem;">CSS<sup>1</sup></a><a href="/tags/Git/" style="font-size: 1.05rem;">Git<sup>1</sup></a><a href="/tags/HTML/" style="font-size: 1.05rem;">HTML<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.05rem;">Java<sup>8</sup></a><a href="/tags/Lambda/" style="font-size: 1.05rem;">Lambda<sup>1</sup></a><a href="/tags/Matlab/" style="font-size: 1.05rem;">Matlab<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 1.05rem;">MySQL<sup>1</sup></a><a href="/tags/Optional/" style="font-size: 1.05rem;">Optional<sup>1</sup></a><a href="/tags/Stream-%E6%B5%81/" style="font-size: 1.05rem;">Stream 流<sup>1</sup></a><a href="/tags/Web/" style="font-size: 1.05rem;">Web<sup>6</sup></a><a href="/tags/%E4%BA%8B%E5%8A%A1/" style="font-size: 1.05rem;">事务<sup>4</sup></a><a href="/tags/%E5%87%BD%E6%95%B0/" style="font-size: 1.05rem;">函数<sup>4</sup></a><a href="/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3/" style="font-size: 1.05rem;">函数式接口<sup>1</sup></a><a href="/tags/%E5%88%86%E6%94%AF/" style="font-size: 1.05rem;">分支<sup>1</sup></a><a href="/tags/%E5%8F%8D%E5%B0%84/" style="font-size: 1.05rem;">反射<sup>1</sup></a><a href="/tags/%E5%91%BD%E4%BB%A4/" style="font-size: 1.05rem;">命令<sup>2</sup></a><a href="/tags/%E5%9B%BE%E5%83%8F%E7%BB%98%E5%88%B6/" style="font-size: 1.05rem;">图像绘制<sup>1</sup></a><a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 1.05rem;">多线程<sup>1</sup></a><a href="/tags/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B/" style="font-size: 1.05rem;">存储过程<sup>1</sup></a><a href="/tags/%E5%AE%9A%E6%97%B6%E5%99%A8/" style="font-size: 1.05rem;">定时器<sup>2</sup></a><a href="/tags/%E5%B1%9E%E6%80%A7/" style="font-size: 1.05rem;">属性<sup>2</sup></a><a href="/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8/" style="font-size: 1.05rem;">异常处理器<sup>1</sup></a><a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 1.05rem;">数学<sup>2</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.05rem;">数据库<sup>2</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" style="font-size: 1.05rem;">数据类型<sup>4</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1%E4%B8%8E%E8%AE%A1%E7%AE%97/" style="font-size: 1.05rem;">数据统计与计算<sup>1</sup></a><a href="/tags/%E6%96%87%E4%BB%B6/" style="font-size: 1.05rem;">文件<sup>1</sup></a><a href="/tags/%E6%96%B0%E7%89%B9%E6%80%A7/" style="font-size: 1.05rem;">新特性<sup>1</sup></a><a href="/tags/%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D/" style="font-size: 1.05rem;">正则匹配<sup>1</sup></a><a href="/tags/%E6%B3%A8%E8%A7%A3/" style="font-size: 1.05rem;">注解<sup>5</sup></a><a href="/tags/%E6%B8%B8%E6%A0%87/" style="font-size: 1.05rem;">游标<sup>1</sup></a><a href="/tags/%E7%AC%A6%E5%8F%B7%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">符号对象<sup>1</sup></a><a href="/tags/%E7%B4%A2%E5%BC%95/" style="font-size: 1.05rem;">索引<sup>1</sup></a><a href="/tags/%E8%A7%86%E5%9B%BE/" style="font-size: 1.05rem;">视图<sup>1</sup></a><a href="/tags/%E8%A7%A6%E5%8F%91%E5%99%A8/" style="font-size: 1.05rem;">触发器<sup>1</sup></a><a href="/tags/%E8%AF%AD%E6%B3%95/" style="font-size: 1.05rem;">语法<sup>8</sup></a><a href="/tags/%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/" style="font-size: 1.05rem;">远程仓库<sup>1</sup></a><a href="/tags/%E9%80%89%E6%8B%A9%E5%99%A8/" style="font-size: 1.05rem;">选择器<sup>1</sup></a><a href="/tags/%E9%94%81/" style="font-size: 1.05rem;">锁<sup>4</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">六月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">四月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">十一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">九月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%85%B6%E4%BB%96/" itemprop="url">其他</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Python/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Python</span></a><a class="article-meta__tags" href="/tags/%E7%AE%97%E6%B3%95/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>算法</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Python 算法模版</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-05-14T16:00:00.000Z" title="发表于 2025-05-15 00:00:00">2025-05-15</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-06-27T07:33:39.271Z" title="更新于 2025-06-27 15:33:39">2025-06-27</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为广州"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>广州</span></div></div></div><article class="post-content" id="article-container" itemscope itemtype="https://kokoachino.github.io/2025/05/15/05%20Python%20%E7%AE%97%E6%B3%95%E6%A8%A1%E7%89%88/"><header><a class="post-meta-categories" href="/categories/%E5%85%B6%E4%BB%96/" itemprop="url">其他</a><a href="/tags/Python/" tabindex="-1" itemprop="url">Python</a><a href="/tags/%E7%AE%97%E6%B3%95/" tabindex="-1" itemprop="url">算法</a><h1 id="CrawlerTitle" itemprop="name headline">Python 算法模版</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">星开祈灵</span><time itemprop="dateCreated datePublished" datetime="2025-05-14T16:00:00.000Z" title="发表于 2025-05-15 00:00:00">2025-05-15</time><time itemprop="dateCreated datePublished" datetime="2025-06-27T07:33:39.271Z" title="更新于 2025-06-27 15:33:39">2025-06-27</time></header><span id="more"></span>



<h1 id="基础模版"><a href="#基础模版" class="headerlink" title="基础模版"></a>基础模版</h1><h3 id="代码模版"><a href="#代码模版" class="headerlink" title="代码模版"></a>代码模版</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># for _ in range(int(input())):</span></span><br><span class="line"><span class="comment">#    n, a = int(input()), map(int, input().split())</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="built_in">input</span> = <span class="keyword">lambda</span>: sys.stdin.readline().rstrip()</span><br><span class="line"><span class="comment"># sys.setrecursionlimit(10 ** 6 + 10)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># from copy import deepcopy</span></span><br><span class="line"><span class="comment"># from decimal import Decimal</span></span><br><span class="line"><span class="comment"># from functools import lru_cache</span></span><br><span class="line"><span class="comment"># from heapq import heappush, heappop</span></span><br><span class="line"><span class="comment"># from bisect import bisect_left, bisect_right</span></span><br><span class="line"><span class="comment"># from datetime import datetime, date, timedelta</span></span><br><span class="line"><span class="comment"># from math import inf, gcd, sqrt, ceil, floor, log</span></span><br><span class="line"><span class="comment"># from collections import Counter, defaultdict, deque</span></span><br><span class="line"><span class="comment"># from random import randint, choice, choices, shuffle</span></span><br><span class="line"><span class="comment"># from itertools import count, accumulate, permutations, combinations, combinations_with_replacement</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">is_more = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(<span class="built_in">input</span>()) <span class="keyword">if</span> is_more <span class="keyword">else</span> <span class="number">1</span>):</span><br><span class="line">    solve()</span><br></pre></td></tr></table></figure>

<h3 id="对拍模版"><a href="#对拍模版" class="headerlink" title="对拍模版"></a>对拍模版</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Callable</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BeatCode</span>: <span class="comment"># 对拍模版</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">ac_fun: <span class="type">Callable</span>, my_fun: <span class="type">Callable</span>, params: <span class="built_in">list</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">for</span> i, param <span class="keyword">in</span> <span class="built_in">enumerate</span>(params):</span><br><span class="line">            ac, my = <span class="built_in">str</span>(ac_fun(*param)), <span class="built_in">str</span>(my_fun(*param))</span><br><span class="line">            <span class="keyword">if</span> ac != my:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">str</span>(i + <span class="number">1</span>) + <span class="string">&#x27; / &#x27;</span> + <span class="built_in">str</span>(<span class="built_in">len</span>(params)))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;测试用例：\n&quot;</span> + <span class="built_in">str</span>(param))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;预期结果：\n&quot;</span> + ac)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;你的输出：\n&quot;</span> + my)</span><br><span class="line">                <span class="keyword">return</span></span><br></pre></td></tr></table></figure>

<h1 id="经典模版"><a href="#经典模版" class="headerlink" title="经典模版"></a>经典模版</h1><h3 id="回文子串"><a href="#回文子串" class="headerlink" title="回文子串"></a>回文子串</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_isP</span>(<span class="params">s: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 判断子串 s[i:j] 是否是回文的</span></span><br><span class="line">    n = <span class="built_in">len</span>(s)</span><br><span class="line">    ans = [[<span class="literal">True</span>] * n <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(j - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            ans[i][j] = s[i] == s[j] <span class="keyword">and</span> ans[i + <span class="number">1</span>][j - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>

<h3 id="回文数"><a href="#回文数" class="headerlink" title="回文数"></a>回文数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_array</span>(<span class="params">U: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 返回所有位于 [1, 10 ^ U] 内的回文数</span></span><br><span class="line">    ans = []</span><br><span class="line">    base = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> base &lt;= <span class="number">10</span> ** ((U - <span class="number">1</span>) // <span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(base, base * <span class="number">10</span>):</span><br><span class="line">            x, t = i, i // <span class="number">10</span></span><br><span class="line">            <span class="keyword">while</span> t:</span><br><span class="line">                x = x * <span class="number">10</span> + t % <span class="number">10</span></span><br><span class="line">                t //= <span class="number">10</span></span><br><span class="line">            ans.append(x)</span><br><span class="line">        <span class="keyword">if</span> base &lt;= <span class="number">10</span> ** (U // <span class="number">2</span> - <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(base, base * <span class="number">10</span>):</span><br><span class="line">                x = t = i</span><br><span class="line">                <span class="keyword">while</span> t:</span><br><span class="line">                    x = x * <span class="number">10</span> + t % <span class="number">10</span></span><br><span class="line">                    t //= <span class="number">10</span></span><br><span class="line">                ans.append(x)</span><br><span class="line">        base *= <span class="number">10</span></span><br><span class="line">    <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>

<h3 id="最长公共子序列"><a href="#最长公共子序列" class="headerlink" title="最长公共子序列"></a>最长公共子序列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">longest_common_subsequence</span>(<span class="params">arr1: <span class="built_in">list</span>, arr2: <span class="built_in">list</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 最长公共子序列</span></span><br><span class="line">    ans = [<span class="number">0</span>] * (<span class="built_in">len</span>(arr2) + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> arr1:</span><br><span class="line">        pre = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j, y <span class="keyword">in</span> <span class="built_in">enumerate</span>(arr2):</span><br><span class="line">            pre, ans[j + <span class="number">1</span>] = ans[j + <span class="number">1</span>], pre + <span class="number">1</span> <span class="keyword">if</span> x == y <span class="keyword">else</span> <span class="built_in">max</span>(ans[j], ans[j + <span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> ans[-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<h3 id="最长递增子序列"><a href="#最长递增子序列" class="headerlink" title="最长递增子序列"></a>最长递增子序列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bisect <span class="keyword">import</span> bisect_left</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">length_of_LIS</span>(<span class="params">nums: <span class="built_in">list</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 最长递增子序列</span></span><br><span class="line">    g = []</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> nums:</span><br><span class="line">        i = bisect_left(g, x)</span><br><span class="line">        <span class="keyword">if</span> i == <span class="built_in">len</span>(g):</span><br><span class="line">            g.append(x)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            g[i] = x</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">len</span>(g)</span><br></pre></td></tr></table></figure>

<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><h3 id="前缀和"><a href="#前缀和" class="headerlink" title="前缀和"></a>前缀和</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">OnePrefixProd</span>: <span class="comment"># 一维前缀积</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nums: <span class="built_in">list</span></span>):</span><br><span class="line">        p = [<span class="number">1</span>] * (<span class="built_in">len</span>(nums) + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">            p[i + <span class="number">1</span>] = p[i] * v</span><br><span class="line">        <span class="variable language_">self</span>.P = p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_prod</span>(<span class="params">self, i: <span class="built_in">int</span>, j: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 区间求积</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.P[j + <span class="number">1</span>] // <span class="variable language_">self</span>.P[i]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OnePrefixSum</span>: <span class="comment"># 一维前缀和</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nums: <span class="built_in">list</span></span>):</span><br><span class="line">        p = [<span class="number">0</span>] * (<span class="built_in">len</span>(nums) + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">            p[i + <span class="number">1</span>] = p[i] + v</span><br><span class="line">        <span class="variable language_">self</span>.P = p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_sum</span>(<span class="params">self, i: <span class="built_in">int</span>, j: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 区间求和</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.P[j + <span class="number">1</span>] - <span class="variable language_">self</span>.P[i]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TwoPrefixSum</span>: <span class="comment"># 二维前缀和</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, mat: <span class="built_in">list</span></span>):</span><br><span class="line">        n, m = <span class="built_in">len</span>(mat), <span class="built_in">len</span>(mat[<span class="number">0</span>])</span><br><span class="line">        p = [[<span class="number">0</span>] * (m + <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">                p[i + <span class="number">1</span>][j + <span class="number">1</span>] = p[i][j + <span class="number">1</span>] + p[i + <span class="number">1</span>][j] - p[i][j] + mat[i][j]</span><br><span class="line">        <span class="variable language_">self</span>.P = p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_sum</span>(<span class="params">self, x1: <span class="built_in">int</span>, y1: <span class="built_in">int</span>, x2: <span class="built_in">int</span>, y2: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 区域求和</span></span><br><span class="line">        P = <span class="variable language_">self</span>.P</span><br><span class="line">        <span class="keyword">return</span> P[x2 + <span class="number">1</span>][y2 + <span class="number">1</span>] - P[x1][y2 + <span class="number">1</span>] - P[x2 + <span class="number">1</span>][y1] + P[x1][y1]</span><br></pre></td></tr></table></figure>

<h3 id="差分"><a href="#差分" class="headerlink" title="差分"></a>差分</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">one_difference</span>(<span class="params">nums: <span class="built_in">list</span>, operates: <span class="built_in">list</span></span>) -&gt; <span class="literal">None</span>: <span class="comment"># 一维差分</span></span><br><span class="line">    n = <span class="built_in">len</span>(nums)</span><br><span class="line">    dif = [<span class="number">0</span>] * (n + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i, j, d <span class="keyword">in</span> operates:</span><br><span class="line">        dif[i] += d</span><br><span class="line">        dif[j + <span class="number">1</span>] -= d</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        dif[i + <span class="number">1</span>] += dif[i]</span><br><span class="line">        nums[i] += dif[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">two_difference</span>(<span class="params">mat: <span class="built_in">list</span>, operates: <span class="built_in">list</span></span>) -&gt; <span class="literal">None</span>: <span class="comment"># 二维差分</span></span><br><span class="line">    n, m = <span class="built_in">len</span>(mat), <span class="built_in">len</span>(mat[<span class="number">0</span>])</span><br><span class="line">    dif = [[<span class="number">0</span>] * (m + <span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">2</span>)]</span><br><span class="line">    <span class="keyword">for</span> x1, y1, x2, y2, d <span class="keyword">in</span> operates:</span><br><span class="line">        dif[x2 + <span class="number">2</span>][y2 + <span class="number">2</span>] += d</span><br><span class="line">        dif[x1 + <span class="number">1</span>][y2 + <span class="number">2</span>] -= d</span><br><span class="line">        dif[x2 + <span class="number">2</span>][y1 + <span class="number">1</span>] -= d</span><br><span class="line">        dif[x1 + <span class="number">1</span>][y1 + <span class="number">1</span>] += d</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, m + <span class="number">1</span>):</span><br><span class="line">            dif[i][j] += dif[i - <span class="number">1</span>][j] + dif[i][j - <span class="number">1</span>] - dif[i - <span class="number">1</span>][j - <span class="number">1</span>]</span><br><span class="line">            mat[i - <span class="number">1</span>][j - <span class="number">1</span>] += dif[i][j]</span><br></pre></td></tr></table></figure>

<h3 id="位运算枚举技巧"><a href="#位运算枚举技巧" class="headerlink" title="位运算枚举技巧"></a>位运算枚举技巧</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">or_list</span>(<span class="params">nums: <span class="built_in">list</span></span>) -&gt; <span class="built_in">set</span>: <span class="comment"># 返回按位或的结果集</span></span><br><span class="line">    ans = <span class="built_in">set</span>(nums)</span><br><span class="line">    <span class="keyword">for</span> i, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> nums[j] | nums[i] == nums[j]:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            nums[j] |= nums[i]</span><br><span class="line">            ans.add(nums[j])</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">and_list</span>(<span class="params">nums: <span class="built_in">list</span></span>) -&gt; <span class="built_in">set</span>: <span class="comment"># 返回按位与的结果集</span></span><br><span class="line">    ans = <span class="built_in">set</span>(nums)</span><br><span class="line">    <span class="keyword">for</span> i, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> nums[j] &amp; nums[i] == nums[j]:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            nums[j] &amp;= nums[i]</span><br><span class="line">            ans.add(nums[j])</span><br><span class="line">    <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>

<h3 id="单调栈"><a href="#单调栈" class="headerlink" title="单调栈"></a>单调栈</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">last_smaller_element</span>(<span class="params">nums: <span class="built_in">list</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 上一个更小元素</span></span><br><span class="line">    n = <span class="built_in">len</span>(nums)</span><br><span class="line">    ans, stack = [-<span class="number">1</span>] * n, []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">while</span> stack <span class="keyword">and</span> nums[i] &lt;= nums[stack[-<span class="number">1</span>]]:</span><br><span class="line">            stack.pop()</span><br><span class="line">        <span class="keyword">if</span> stack:</span><br><span class="line">            ans[i] = stack[-<span class="number">1</span>]</span><br><span class="line">        stack.append(i)</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">last_bigger_element</span>(<span class="params">nums: <span class="built_in">list</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 上一个更大元素</span></span><br><span class="line">    n = <span class="built_in">len</span>(nums)</span><br><span class="line">    ans, stack = [-<span class="number">1</span>] * n, []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">while</span> stack <span class="keyword">and</span> nums[i] &gt;= nums[stack[-<span class="number">1</span>]]:</span><br><span class="line">            stack.pop()</span><br><span class="line">        <span class="keyword">if</span> stack:</span><br><span class="line">            ans[i] = stack[-<span class="number">1</span>]</span><br><span class="line">        stack.append(i)</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_smaller_element</span>(<span class="params">nums: <span class="built_in">list</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 下一个更小元素</span></span><br><span class="line">    n = <span class="built_in">len</span>(nums)</span><br><span class="line">    ans, stack = [n] * n, []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">while</span> stack <span class="keyword">and</span> nums[i] &lt;= nums[stack[-<span class="number">1</span>]]:</span><br><span class="line">            stack.pop()</span><br><span class="line">        <span class="keyword">if</span> stack:</span><br><span class="line">            ans[i] = stack[-<span class="number">1</span>]</span><br><span class="line">        stack.append(i)</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_bigger_element</span>(<span class="params">nums: <span class="built_in">list</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 下一个更大元素</span></span><br><span class="line">    n = <span class="built_in">len</span>(nums)</span><br><span class="line">    ans, stack = [n] * n, []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">while</span> stack <span class="keyword">and</span> nums[i] &gt;= nums[stack[-<span class="number">1</span>]]:</span><br><span class="line">            stack.pop()</span><br><span class="line">        <span class="keyword">if</span> stack:</span><br><span class="line">            ans[i] = stack[-<span class="number">1</span>]</span><br><span class="line">        stack.append(i)</span><br><span class="line">    <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>

<h3 id="单调队列"><a href="#单调队列" class="headerlink" title="单调队列"></a>单调队列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">min_sliding_window</span>(<span class="params">nums: <span class="built_in">list</span>, k: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 滑动窗口最小值</span></span><br><span class="line">    n = <span class="built_in">len</span>(nums)</span><br><span class="line">    ans = [<span class="number">0</span>] * n</span><br><span class="line">    q = deque()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        max_index = <span class="built_in">min</span>(i + k - <span class="number">1</span>, n - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> q <span class="keyword">and</span> q[<span class="number">0</span>] &gt; max_index:</span><br><span class="line">            q.popleft()</span><br><span class="line">        <span class="keyword">while</span> q <span class="keyword">and</span> nums[i] &lt;= nums[q[-<span class="number">1</span>]]:</span><br><span class="line">            q.pop()</span><br><span class="line">        q.append(i)</span><br><span class="line">        ans[i] = nums[q[<span class="number">0</span>]]</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">max_sliding_window</span>(<span class="params">nums: <span class="built_in">list</span>, k: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 滑动窗口最大值</span></span><br><span class="line">    n = <span class="built_in">len</span>(nums)</span><br><span class="line">    ans = [<span class="number">0</span>] * n</span><br><span class="line">    q = deque()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        max_index = <span class="built_in">min</span>(i + k - <span class="number">1</span>, n - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> q <span class="keyword">and</span> q[<span class="number">0</span>] &gt; max_index:</span><br><span class="line">            q.popleft()</span><br><span class="line">        <span class="keyword">while</span> q <span class="keyword">and</span> nums[i] &gt;= nums[q[-<span class="number">1</span>]]:</span><br><span class="line">            q.pop()</span><br><span class="line">        q.append(i)</span><br><span class="line">        ans[i] = nums[q[<span class="number">0</span>]]</span><br><span class="line">    <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>

<h1 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h1><h3 id="字符串哈希"><a href="#字符串哈希" class="headerlink" title="字符串哈希"></a>字符串哈希</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StringHash</span>: <span class="comment"># 字符串哈希</span></span><br><span class="line"></span><br><span class="line">    BASE, MOD = randint(<span class="number">8</span> * <span class="number">10</span> ** <span class="number">8</span>, <span class="number">9</span> * <span class="number">10</span> ** <span class="number">8</span>), <span class="number">1070777777</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, s: <span class="built_in">str</span></span>):</span><br><span class="line">        n = <span class="built_in">len</span>(s)</span><br><span class="line">        BASE, MOD = StringHash.BASE, StringHash.MOD</span><br><span class="line">        <span class="variable language_">self</span>.pow_base, <span class="variable language_">self</span>.pre_hash = [<span class="number">1</span>] * (n + <span class="number">1</span>), [<span class="number">0</span>] * (n + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(s):</span><br><span class="line">            <span class="variable language_">self</span>.pow_base[i + <span class="number">1</span>] = <span class="variable language_">self</span>.pow_base[i] * BASE % MOD</span><br><span class="line">            <span class="variable language_">self</span>.pre_hash[i + <span class="number">1</span>] = (<span class="variable language_">self</span>.pre_hash[i] * BASE + <span class="built_in">ord</span>(c)) % MOD</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sub_hash</span>(<span class="params">self, l: <span class="built_in">int</span>, r: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 计算子字符串的哈希值</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="variable language_">self</span>.pre_hash[r + <span class="number">1</span>] - <span class="variable language_">self</span>.pre_hash[l] * <span class="variable language_">self</span>.pow_base[r - l + <span class="number">1</span>]) % StringHash.MOD</span><br></pre></td></tr></table></figure>

<h3 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">kmp</span>(<span class="params">s: <span class="built_in">str</span>, t: <span class="built_in">str</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># s：主串 t：目标串</span></span><br><span class="line">    m, n = <span class="built_in">len</span>(s), <span class="built_in">len</span>(t)</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">    <span class="built_in">next</span> = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">        <span class="keyword">while</span> j &gt; <span class="number">0</span> <span class="keyword">and</span> t[i] != t[j]:</span><br><span class="line">            j = <span class="built_in">next</span>[j - <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> t[i] == t[j]:</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        <span class="built_in">next</span>[i] = j</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">while</span> j &gt; <span class="number">0</span> <span class="keyword">and</span> s[i] != t[j]:</span><br><span class="line">            j = <span class="built_in">next</span>[j - <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> s[i] == t[j]:</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> j == n:</span><br><span class="line">            <span class="keyword">return</span> i - n + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="Z-函数"><a href="#Z-函数" class="headerlink" title="Z 函数"></a>Z 函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">calc_z</span>(<span class="params">s: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># Z 函数</span></span><br><span class="line">    n = <span class="built_in">len</span>(s)</span><br><span class="line">    z = [<span class="number">0</span>] * n</span><br><span class="line">    z[<span class="number">0</span>] = n</span><br><span class="line">    l = r = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">        <span class="keyword">if</span> i &lt;= r:</span><br><span class="line">            z[i] = z[i - l] <span class="keyword">if</span> z[i - l] &lt; r - i + <span class="number">1</span> <span class="keyword">else</span> r - i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> i + z[i] &lt; n <span class="keyword">and</span> s[z[i]] == s[i + z[i]]:</span><br><span class="line">            l, r = i, i + z[i]</span><br><span class="line">            z[i] += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> z</span><br></pre></td></tr></table></figure>

<h3 id="字典树"><a href="#字典树" class="headerlink" title="字典树"></a>字典树</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TrieNode</span>: <span class="comment"># 字典树节点</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.children = &#123;&#125;</span><br><span class="line">        <span class="variable language_">self</span>.is_word = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Trie</span>: <span class="comment"># 字典树</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.root = TrieNode()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">insert</span>(<span class="params">self, word: <span class="built_in">str</span></span>): <span class="comment"># 插入单词</span></span><br><span class="line">        p = <span class="variable language_">self</span>.root</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> word:</span><br><span class="line">            <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> p.children:</span><br><span class="line">                p.children[c] = TrieNode()</span><br><span class="line">            p = p.children[c]</span><br><span class="line">        p.is_word = <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">search_prefix</span>(<span class="params">self, word: <span class="built_in">str</span></span>) -&gt; TrieNode(): <span class="comment"># 查找前缀</span></span><br><span class="line">        p = <span class="variable language_">self</span>.root</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> word:</span><br><span class="line">            <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> p.children:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            p = p.children[c]</span><br><span class="line">        <span class="keyword">return</span> p</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">search</span>(<span class="params">self, word: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>: <span class="comment"># 查找单词</span></span><br><span class="line">        p = <span class="variable language_">self</span>.search_prefix(word)</span><br><span class="line">        <span class="keyword">return</span> p <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> p.is_word</span><br></pre></td></tr></table></figure>

<h1 id="图论"><a href="#图论" class="headerlink" title="图论"></a>图论</h1><h3 id="Dijkstra"><a href="#Dijkstra" class="headerlink" title="Dijkstra"></a>Dijkstra</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> heapq <span class="keyword">import</span> heappush, heappop</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> inf</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dijkstra</span>(<span class="params">mat: <span class="built_in">list</span>, a: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 单源最短路</span></span><br><span class="line">    n = <span class="built_in">len</span>(mat)</span><br><span class="line">    ans = [inf] * n</span><br><span class="line">    ans[a] = <span class="number">0</span></span><br><span class="line">    q = deque([a])</span><br><span class="line">    <span class="keyword">while</span> q:</span><br><span class="line">        x = q.popleft()</span><br><span class="line">        <span class="keyword">for</span> y, d <span class="keyword">in</span> <span class="built_in">enumerate</span>(mat[x]):</span><br><span class="line">            <span class="keyword">if</span> ans[y] &gt; ans[x] + d:</span><br><span class="line">                ans[y] = ans[x] + d</span><br><span class="line">                q.append(y)</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dijkstra</span>(<span class="params">g: <span class="built_in">list</span>, a: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 堆优化的单源最短路</span></span><br><span class="line">    n = <span class="built_in">len</span>(g)</span><br><span class="line">    ans, st, q = [inf] * n, [<span class="literal">False</span>] * n, []</span><br><span class="line">    ans[a] = <span class="number">0</span></span><br><span class="line">    heappush(q, (<span class="number">0</span>, a))</span><br><span class="line">    <span class="keyword">while</span> q:</span><br><span class="line">        dist, x = heappop(q)</span><br><span class="line">        <span class="keyword">if</span> st[x]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        st[x] = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> g[x]:</span><br><span class="line">            y, d = t</span><br><span class="line">            <span class="keyword">if</span> ans[y] &gt; ans[x] + d:</span><br><span class="line">                ans[y] = ans[x] + d</span><br><span class="line">                heappush(q, (ans[y], y))</span><br><span class="line">    <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>

<h3 id="Floyd"><a href="#Floyd" class="headerlink" title="Floyd"></a>Floyd</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">floyd</span>(<span class="params">mat: <span class="built_in">list</span></span>) -&gt; <span class="literal">None</span>: <span class="comment"># 全源最短路</span></span><br><span class="line">    n = <span class="built_in">len</span>(mat)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">                <span class="keyword">if</span> mat[i][j] &gt; mat[i][k] + mat[k][j]:</span><br><span class="line">                    mat[i][j] = mat[i][k] + mat[k][j]</span><br></pre></td></tr></table></figure>

<h3 id="拓扑排序"><a href="#拓扑排序" class="headerlink" title="拓扑排序"></a>拓扑排序</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">n: <span class="built_in">int</span>, edges: <span class="built_in">list</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 返回该有向无环图的拓扑排序</span></span><br><span class="line">    g, deg = [[] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)], [<span class="number">0</span>] * n</span><br><span class="line">    <span class="keyword">for</span> u, v <span class="keyword">in</span> edges:</span><br><span class="line">        g[u].append(v)</span><br><span class="line">        deg[v] += <span class="number">1</span></span><br><span class="line">    ans = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n) <span class="keyword">if</span> deg[i] == <span class="number">0</span>]</span><br><span class="line">    q = deque(ans)</span><br><span class="line">    <span class="keyword">while</span> q:</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> g[q.popleft()]:</span><br><span class="line">            deg[x] -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> deg[x] == <span class="number">0</span>:</span><br><span class="line">                q.append(x)</span><br><span class="line">                ans.append(x)</span><br><span class="line">    <span class="keyword">return</span> ans <span class="keyword">if</span> <span class="built_in">len</span>(ans) == n <span class="keyword">else</span> []</span><br></pre></td></tr></table></figure>

<h3 id="并查集"><a href="#并查集" class="headerlink" title="并查集"></a>并查集</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UnionFindSet</span>: <span class="comment"># 并查集</span></span><br><span class="line"></span><br><span class="line">    __slots__ = (<span class="string">&quot;n&quot;</span>, <span class="string">&quot;fa&quot;</span>, <span class="string">&quot;size&quot;</span>, <span class="string">&quot;cnt&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n: <span class="built_in">int</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.n = n</span><br><span class="line">        <span class="variable language_">self</span>.fa = <span class="built_in">list</span>(<span class="built_in">range</span>(n))</span><br><span class="line">        <span class="variable language_">self</span>.size = [<span class="number">1</span>] * n</span><br><span class="line">        <span class="variable language_">self</span>.cnt = n</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">self, x: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 查找元素 x 所在集合的代表元素</span></span><br><span class="line">        ans, fa = x, <span class="variable language_">self</span>.fa</span><br><span class="line">        <span class="keyword">while</span> fa[ans] != ans:</span><br><span class="line">            ans = fa[ans]</span><br><span class="line">        <span class="keyword">while</span> fa[x] != ans:</span><br><span class="line">            fa[x], x = ans, fa[x]</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">self, i: <span class="built_in">int</span>, j: <span class="built_in">int</span></span>): <span class="comment"># 合并元素 i 和 j 所在的集合</span></span><br><span class="line">        fa, size = <span class="variable language_">self</span>.fa, <span class="variable language_">self</span>.size</span><br><span class="line">        x, y = <span class="variable language_">self</span>.find(i), <span class="variable language_">self</span>.find(j)</span><br><span class="line">        <span class="keyword">if</span> x == y:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> size[x] &gt; size[y]:</span><br><span class="line">            x, y = y, x</span><br><span class="line">        fa[x] = y</span><br><span class="line">        size[y] += size[x]</span><br><span class="line">        <span class="variable language_">self</span>.cnt -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_same</span>(<span class="params">self, i: <span class="built_in">int</span>, j: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bool</span>: <span class="comment"># 判断元素 i 和 j 是否属于同一集合</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.find(i) == <span class="variable language_">self</span>.find(j)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_size</span>(<span class="params">self, x: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 查询元素 x 所在集合的元素个数</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.size[<span class="variable language_">self</span>.find(x)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_cnt</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 查询不同集合的个数</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.cnt</span><br></pre></td></tr></table></figure>

<h1 id="动态规划"><a href="#动态规划" class="headerlink" title="动态规划"></a>动态规划</h1><h3 id="数位-DP"><a href="#数位-DP" class="headerlink" title="数位 DP"></a>数位 DP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> cache</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">digitalDP</span>(<span class="params">n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 数位 DP 通用模板</span></span><br><span class="line">    s = <span class="built_in">str</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @cache</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">i: <span class="built_in">int</span>, is_limit: <span class="built_in">bool</span>, is_num: <span class="built_in">bool</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">if</span> i == <span class="built_in">len</span>(s):</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(is_num)</span><br><span class="line">        ret = <span class="number">0</span> <span class="keyword">if</span> is_num <span class="keyword">else</span> dfs(i + <span class="number">1</span>, <span class="literal">False</span>, <span class="literal">False</span>)</span><br><span class="line">        up = <span class="built_in">int</span>(s[i]) <span class="keyword">if</span> is_limit <span class="keyword">else</span> <span class="number">9</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span> - <span class="built_in">int</span>(is_num), up + <span class="number">1</span>):</span><br><span class="line">            ret += dfs(i + <span class="number">1</span>, j == up <span class="keyword">and</span> is_limit, <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> dfs(<span class="number">0</span>, <span class="literal">True</span>, <span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h3 id="矩阵快速幂"><a href="#矩阵快速幂" class="headerlink" title="矩阵快速幂"></a>矩阵快速幂</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mat_mul</span>(<span class="params">a: <span class="built_in">list</span>, b: <span class="built_in">list</span>, MOD = <span class="number">10</span> ** <span class="number">9</span> + <span class="number">7</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 矩阵乘法 a * b = c</span></span><br><span class="line">    m, t, n = <span class="built_in">len</span>(a), <span class="built_in">len</span>(b), <span class="built_in">len</span>(b[<span class="number">0</span>])</span><br><span class="line">    c = [[<span class="number">0</span>] * n <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            c[i][j] = <span class="built_in">sum</span>(a[i][k] * b[k][j] <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(t)) % MOD</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mat_pow</span>(<span class="params">a: <span class="built_in">list</span>, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 矩阵幂运算 a ^ n = res</span></span><br><span class="line">    m = <span class="built_in">len</span>(a)</span><br><span class="line">    res, a = [[<span class="number">0</span>] * m <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m)], deepcopy(a)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        res[i][i] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> n:</span><br><span class="line">        <span class="keyword">if</span> n &amp; <span class="number">1</span>:</span><br><span class="line">            res = mat_mul(res, a)</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span></span><br><span class="line">        a = mat_mul(a, a)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mat_pow</span>(<span class="params">a: <span class="built_in">list</span>, n: <span class="built_in">int</span>, MOD = <span class="number">10</span> ** <span class="number">9</span> + <span class="number">7</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 矩阵幂运算 a ^ n = res</span></span><br><span class="line">    a = np.array(a, dtype=<span class="built_in">object</span>)</span><br><span class="line">    res = np.eye(a.shape[<span class="number">0</span>], dtype=<span class="built_in">object</span>)</span><br><span class="line">    <span class="keyword">while</span> n:</span><br><span class="line">        <span class="keyword">if</span> n &amp; <span class="number">1</span>:</span><br><span class="line">            res = np.dot(res, a) % MOD</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span></span><br><span class="line">        a = np.dot(a, a) % MOD</span><br><span class="line">    <span class="keyword">return</span> res.tolist()</span><br></pre></td></tr></table></figure>

<h1 id="数论"><a href="#数论" class="headerlink" title="数论"></a>数论</h1><h3 id="质数筛选"><a href="#质数筛选" class="headerlink" title="质数筛选"></a>质数筛选</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_primes</span>(<span class="params">n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 埃氏筛</span></span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> [<span class="literal">False</span>] * (n + <span class="number">1</span>)</span><br><span class="line">    ans = [<span class="literal">True</span>] * (n + <span class="number">1</span>)</span><br><span class="line">    ans[<span class="number">0</span>] = ans[<span class="number">1</span>] = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> ans[i]:</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i * i, n + <span class="number">1</span>, i):</span><br><span class="line">                ans[j] = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>

<h3 id="质因数分解"><a href="#质因数分解" class="headerlink" title="质因数分解"></a>质因数分解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_primes</span>(<span class="params">n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 质因数分解</span></span><br><span class="line">    i, ans = <span class="number">2</span>, []</span><br><span class="line">    <span class="keyword">while</span> i ** <span class="number">2</span> &lt;= n:</span><br><span class="line">        <span class="keyword">if</span> n % i == <span class="number">0</span>:</span><br><span class="line">            ans.append([i, <span class="number">0</span>])</span><br><span class="line">            <span class="keyword">while</span> n % i == <span class="number">0</span>:</span><br><span class="line">                n //= i</span><br><span class="line">                ans[-<span class="number">1</span>][<span class="number">1</span>] += <span class="number">1</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> n &gt; <span class="number">1</span>:</span><br><span class="line">        ans.append([n, <span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>

<h3 id="乘法逆元"><a href="#乘法逆元" class="headerlink" title="乘法逆元"></a>乘法逆元</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_inv</span>(<span class="params">n: <span class="built_in">int</span>, MOD = <span class="number">10</span> ** <span class="number">9</span> + <span class="number">7</span></span>) -&gt; <span class="built_in">list</span>: <span class="comment"># 返回所有位于 [1, n] 的整数在模 MOD 意义下的乘法逆元</span></span><br><span class="line">    inv = [<span class="number">1</span>] * (n + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n + <span class="number">1</span>):</span><br><span class="line">        inv[i] = (MOD - MOD // i) * inv[MOD % i] % MOD</span><br><span class="line">    <span class="keyword">return</span> inv</span><br></pre></td></tr></table></figure>

<h1 id="高级数据结构"><a href="#高级数据结构" class="headerlink" title="高级数据结构"></a>高级数据结构</h1><h3 id="树状数组-Sum"><a href="#树状数组-Sum" class="headerlink" title="树状数组 Sum"></a>树状数组 Sum</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BinaryIndexedTreesSum</span>: <span class="comment"># 树状数组 Sum</span></span><br><span class="line"></span><br><span class="line">    __slots__ = (<span class="string">&quot;n&quot;</span>, <span class="string">&quot;d&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nums: <span class="built_in">list</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.n = <span class="built_in">len</span>(nums) + <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.d = [<span class="number">0</span>] * <span class="variable language_">self</span>.n</span><br><span class="line">        <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">            <span class="variable language_">self</span>.update(i, v)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">query</span>(<span class="params">self, i: <span class="built_in">int</span>, j = -<span class="number">1</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 区间查询</span></span><br><span class="line">        <span class="keyword">if</span> j &lt; <span class="number">0</span>:</span><br><span class="line">            ans = <span class="number">0</span></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> i &gt; <span class="number">0</span>:</span><br><span class="line">                ans += <span class="variable language_">self</span>.d[i]</span><br><span class="line">                i &amp;= i - <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> ans</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>.query(j) - <span class="variable language_">self</span>.query(i - <span class="number">1</span>)    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, i: <span class="built_in">int</span>, k: <span class="built_in">int</span></span>): <span class="comment"># 单点修改</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; <span class="variable language_">self</span>.n:</span><br><span class="line">            <span class="variable language_">self</span>.d[i] += k</span><br><span class="line">            i += i &amp; -i</span><br></pre></td></tr></table></figure>

<h3 id="树状数组-Min"><a href="#树状数组-Min" class="headerlink" title="树状数组 Min"></a>树状数组 Min</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> inf</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BinaryIndexedTreesMin</span>: <span class="comment"># 树状数组 Min</span></span><br><span class="line"></span><br><span class="line">    __slots__ = (<span class="string">&quot;n&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;d&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nums: <span class="built_in">list</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.n = <span class="built_in">len</span>(nums) + <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.a = [inf] * <span class="variable language_">self</span>.n</span><br><span class="line">        <span class="variable language_">self</span>.d = [inf] * <span class="variable language_">self</span>.n</span><br><span class="line">        <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">            <span class="variable language_">self</span>.update(i, v)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">query</span>(<span class="params">self, i: <span class="built_in">int</span>, j: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 区间查询</span></span><br><span class="line">        ans = inf</span><br><span class="line">        i += <span class="number">1</span>; j += <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> i &lt;= j:</span><br><span class="line">            <span class="keyword">if</span> ans &gt; <span class="variable language_">self</span>.a[j]:</span><br><span class="line">                ans = <span class="variable language_">self</span>.a[j]</span><br><span class="line">            j -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> i &lt;= j - (j &amp; -j):</span><br><span class="line">                <span class="keyword">if</span> ans &gt; <span class="variable language_">self</span>.d[j]:</span><br><span class="line">                    ans = <span class="variable language_">self</span>.d[j]</span><br><span class="line">                j -= j &amp; -j</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, i: <span class="built_in">int</span>, val: <span class="built_in">int</span></span>): <span class="comment"># 单点修改</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.a[i] = val</span><br><span class="line">        <span class="keyword">while</span> i &lt; <span class="variable language_">self</span>.n:</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.d[i] &gt; val:</span><br><span class="line">                <span class="variable language_">self</span>.d[i] = val</span><br><span class="line">            i += i &amp; -i</span><br></pre></td></tr></table></figure>

<h3 id="树状数组-Max"><a href="#树状数组-Max" class="headerlink" title="树状数组 Max"></a>树状数组 Max</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> inf</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BinaryIndexedTreesMax</span>: <span class="comment"># 树状数组 Max</span></span><br><span class="line"></span><br><span class="line">    __slots__ = (<span class="string">&quot;n&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;d&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nums: <span class="built_in">list</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.n = <span class="built_in">len</span>(nums) + <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.a = [-inf] * <span class="variable language_">self</span>.n</span><br><span class="line">        <span class="variable language_">self</span>.d = [-inf] * <span class="variable language_">self</span>.n</span><br><span class="line">        <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">            <span class="variable language_">self</span>.update(i, v)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">query</span>(<span class="params">self, i: <span class="built_in">int</span>, j: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 区间查询</span></span><br><span class="line">        ans = -inf</span><br><span class="line">        i += <span class="number">1</span>; j += <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> i &lt;= j:</span><br><span class="line">            <span class="keyword">if</span> ans &lt; <span class="variable language_">self</span>.a[j]:</span><br><span class="line">                ans = <span class="variable language_">self</span>.a[j]</span><br><span class="line">            j -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> i &lt;= j - (j &amp; -j):</span><br><span class="line">                <span class="keyword">if</span> ans &lt; <span class="variable language_">self</span>.d[j]:</span><br><span class="line">                    ans = <span class="variable language_">self</span>.d[j]</span><br><span class="line">                j -= j &amp; -j</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, i: <span class="built_in">int</span>, val: <span class="built_in">int</span></span>): <span class="comment"># 单点修改</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.a[i] = val</span><br><span class="line">        <span class="keyword">while</span> i &lt; <span class="variable language_">self</span>.n:</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.d[i] &lt; val:</span><br><span class="line">                <span class="variable language_">self</span>.d[i] = val</span><br><span class="line">            i += i &amp; -i</span><br></pre></td></tr></table></figure>

<h3 id="线段树"><a href="#线段树" class="headerlink" title="线段树"></a>线段树</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SegmentTree</span>: <span class="comment"># 线段树</span></span><br><span class="line"></span><br><span class="line">    __slots__ = (<span class="string">&quot;n&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;lazy&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nums</span>):</span><br><span class="line">        <span class="variable language_">self</span>.n = <span class="built_in">len</span>(nums)</span><br><span class="line">        <span class="variable language_">self</span>.d = [<span class="number">0</span>] * (<span class="number">1</span> &lt;&lt; (<span class="variable language_">self</span>.n.bit_length() + <span class="number">1</span>))</span><br><span class="line">        <span class="variable language_">self</span>.lazy = <span class="variable language_">self</span>.d.copy()</span><br><span class="line">        <span class="variable language_">self</span>.__build__(nums, <span class="number">0</span>, <span class="variable language_">self</span>.n - <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__build__</span>(<span class="params">self, nums, left: <span class="built_in">int</span>, right: <span class="built_in">int</span>, i: <span class="built_in">int</span></span>): <span class="comment"># 建树</span></span><br><span class="line">        <span class="keyword">if</span> left == right:</span><br><span class="line">            <span class="variable language_">self</span>.d[i] = nums[left]</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        mid = (left + right) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.__build__(nums, left, mid, <span class="number">2</span> * i)</span><br><span class="line">        <span class="variable language_">self</span>.__build__(nums, mid + <span class="number">1</span>, right, <span class="number">2</span> * i + <span class="number">1</span>)</span><br><span class="line">        <span class="variable language_">self</span>.d[i] = <span class="variable language_">self</span>.d[<span class="number">2</span> * i] + <span class="variable language_">self</span>.d[<span class="number">2</span> * i + <span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__query__</span>(<span class="params">self, start: <span class="built_in">int</span>, end: <span class="built_in">int</span>, left: <span class="built_in">int</span>, right: <span class="built_in">int</span>, i: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 区间查询</span></span><br><span class="line">        <span class="keyword">if</span> left &gt;= start <span class="keyword">and</span> right &lt;= end:</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>.d[i]</span><br><span class="line">        ret, mid = <span class="number">0</span>, (left + right) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.lazy[i] <span class="keyword">and</span> left != right:</span><br><span class="line">            <span class="variable language_">self</span>.d[<span class="number">2</span> * i] += (mid - left + <span class="number">1</span>) * <span class="variable language_">self</span>.lazy[i]</span><br><span class="line">            <span class="variable language_">self</span>.d[<span class="number">2</span> * i + <span class="number">1</span>] += (right - mid) * <span class="variable language_">self</span>.lazy[i]</span><br><span class="line">            <span class="variable language_">self</span>.lazy[<span class="number">2</span> * i] += <span class="variable language_">self</span>.lazy[i]</span><br><span class="line">            <span class="variable language_">self</span>.lazy[<span class="number">2</span> * i + <span class="number">1</span>] += <span class="variable language_">self</span>.lazy[i]</span><br><span class="line">            <span class="variable language_">self</span>.lazy[i] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> start &lt;= mid:</span><br><span class="line">            ret += <span class="variable language_">self</span>.__query__(start, end, left, mid, <span class="number">2</span> * i)</span><br><span class="line">        <span class="keyword">if</span> end &gt;= mid + <span class="number">1</span>:</span><br><span class="line">            ret += <span class="variable language_">self</span>.__query__(start, end, mid + <span class="number">1</span>, right, <span class="number">2</span> * i + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__update__</span>(<span class="params">self, start: <span class="built_in">int</span>, end: <span class="built_in">int</span>, k: <span class="built_in">int</span>, left: <span class="built_in">int</span>, right: <span class="built_in">int</span>, i: <span class="built_in">int</span></span>): <span class="comment"># 区间修改</span></span><br><span class="line">        <span class="keyword">if</span> left &gt;= start <span class="keyword">and</span> right &lt;= end:</span><br><span class="line">            <span class="variable language_">self</span>.d[i] += (right - left + <span class="number">1</span>) * k</span><br><span class="line">            <span class="variable language_">self</span>.lazy[i] += k</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        mid = (left + right) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.lazy[i] <span class="keyword">and</span> left != right:</span><br><span class="line">            <span class="variable language_">self</span>.d[<span class="number">2</span> * i] += (mid - left + <span class="number">1</span>) * <span class="variable language_">self</span>.lazy[i]</span><br><span class="line">            <span class="variable language_">self</span>.d[<span class="number">2</span> * i + <span class="number">1</span>] += (right - mid) * <span class="variable language_">self</span>.lazy[i]</span><br><span class="line">            <span class="variable language_">self</span>.lazy[<span class="number">2</span> * i] += <span class="variable language_">self</span>.lazy[i]</span><br><span class="line">            <span class="variable language_">self</span>.lazy[<span class="number">2</span> * i + <span class="number">1</span>] += <span class="variable language_">self</span>.lazy[i]</span><br><span class="line">            <span class="variable language_">self</span>.lazy[i] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> start &lt;= mid:</span><br><span class="line">            <span class="variable language_">self</span>.__update__(start, end, k, left, mid, <span class="number">2</span> * i)</span><br><span class="line">        <span class="keyword">if</span> end &gt;= mid + <span class="number">1</span>:</span><br><span class="line">            <span class="variable language_">self</span>.__update__(start, end, k, mid + <span class="number">1</span>, right, <span class="number">2</span> * i + <span class="number">1</span>)</span><br><span class="line">        <span class="variable language_">self</span>.d[i] = <span class="variable language_">self</span>.d[<span class="number">2</span> * i] + <span class="variable language_">self</span>.d[<span class="number">2</span> * i + <span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">query</span>(<span class="params">self, start: <span class="built_in">int</span>, end: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>: <span class="comment"># 区间查询</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__query__(start, end, <span class="number">0</span>, <span class="variable language_">self</span>.n - <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, start: <span class="built_in">int</span>, end: <span class="built_in">int</span>, k: <span class="built_in">int</span></span>): <span class="comment"># 区间修改</span></span><br><span class="line">        <span class="variable language_">self</span>.__update__(start, end, k, <span class="number">0</span>, <span class="variable language_">self</span>.n - <span class="number">1</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h3 id="平衡树"><a href="#平衡树" class="headerlink" title="平衡树"></a>平衡树</h3><blockquote>
<p>sortedcontainers 源码</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> traceback</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> bisect <span class="keyword">import</span> bisect_left, bisect_right, insort</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain, repeat, starmap</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> add, eq, ne, gt, ge, lt, le, iadd</span><br><span class="line"><span class="keyword">from</span> textwrap <span class="keyword">import</span> dedent</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">from</span> collections.abc <span class="keyword">import</span> <span class="type">Sequence</span>, MutableSequence</span><br><span class="line"><span class="keyword">except</span> ImportError:</span><br><span class="line">    <span class="keyword">from</span> collections <span class="keyword">import</span> <span class="type">Sequence</span>, MutableSequence</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> hexversion</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> hexversion &lt; <span class="number">0x03000000</span>:</span><br><span class="line">    <span class="keyword">from</span> itertools <span class="keyword">import</span> imap <span class="keyword">as</span> <span class="built_in">map</span>  </span><br><span class="line">    <span class="keyword">from</span> itertools <span class="keyword">import</span> izip <span class="keyword">as</span> <span class="built_in">zip</span>  </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">from</span> thread <span class="keyword">import</span> get_ident</span><br><span class="line">    <span class="keyword">except</span> ImportError:</span><br><span class="line">        <span class="keyword">from</span> dummy_thread <span class="keyword">import</span> get_ident</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">from</span> _thread <span class="keyword">import</span> get_ident</span><br><span class="line">    <span class="keyword">except</span> ImportError:</span><br><span class="line">        <span class="keyword">from</span> _dummy_thread <span class="keyword">import</span> get_ident</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recursive_repr</span>(<span class="params">fillvalue=<span class="string">&#x27;...&#x27;</span></span>):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorating_function</span>(<span class="params">user_function</span>):</span><br><span class="line">        repr_running = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line"><span class="meta">        @wraps(<span class="params">user_function</span>)</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">self</span>):</span><br><span class="line">            key = <span class="built_in">id</span>(<span class="variable language_">self</span>), get_ident()</span><br><span class="line">            <span class="keyword">if</span> key <span class="keyword">in</span> repr_running:</span><br><span class="line">                <span class="keyword">return</span> fillvalue</span><br><span class="line">            repr_running.add(key)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                result = user_function(<span class="variable language_">self</span>)</span><br><span class="line">            <span class="keyword">finally</span>:</span><br><span class="line">                repr_running.discard(key)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> decorating_function</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SortedList</span>(<span class="title class_ inherited__">MutableSequence</span>):</span><br><span class="line"></span><br><span class="line">    DEFAULT_LOAD_FACTOR = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, iterable=<span class="literal">None</span>, key=<span class="literal">None</span></span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> key <span class="keyword">is</span> <span class="literal">None</span></span><br><span class="line">        <span class="variable language_">self</span>._<span class="built_in">len</span> = <span class="number">0</span></span><br><span class="line">        <span class="variable language_">self</span>._load = <span class="variable language_">self</span>.DEFAULT_LOAD_FACTOR</span><br><span class="line">        <span class="variable language_">self</span>._lists = []</span><br><span class="line">        <span class="variable language_">self</span>._maxes = []</span><br><span class="line">        <span class="variable language_">self</span>._index = []</span><br><span class="line">        <span class="variable language_">self</span>._offset = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> iterable <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="variable language_">self</span>._update(iterable)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls, iterable=<span class="literal">None</span>, key=<span class="literal">None</span></span>):</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">object</span>.__new__(cls)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> cls <span class="keyword">is</span> SortedList:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">object</span>.__new__(SortedKeyList)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> TypeError(<span class="string">&#x27;inherit SortedKeyList for key argument&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">key</span>(<span class="params">self</span>):  </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_reset</span>(<span class="params">self, load</span>):</span><br><span class="line"></span><br><span class="line">        values = reduce(iadd, <span class="variable language_">self</span>._lists, [])</span><br><span class="line">        <span class="variable language_">self</span>._clear()</span><br><span class="line">        <span class="variable language_">self</span>._load = load</span><br><span class="line">        <span class="variable language_">self</span>._update(values)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">clear</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>._<span class="built_in">len</span> = <span class="number">0</span></span><br><span class="line">        <span class="keyword">del</span> <span class="variable language_">self</span>._lists[:]</span><br><span class="line">        <span class="keyword">del</span> <span class="variable language_">self</span>._maxes[:]</span><br><span class="line">        <span class="keyword">del</span> <span class="variable language_">self</span>._index[:]</span><br><span class="line">        <span class="variable language_">self</span>._offset = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    _clear = clear</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">self, value</span>):</span><br><span class="line"></span><br><span class="line">        _lists = <span class="variable language_">self</span>._lists</span><br><span class="line">        _maxes = <span class="variable language_">self</span>._maxes</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> _maxes:</span><br><span class="line">            pos = bisect_right(_maxes, value)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> pos == <span class="built_in">len</span>(_maxes):</span><br><span class="line">                pos -= <span class="number">1</span></span><br><span class="line">                _lists[pos].append(value)</span><br><span class="line">                _maxes[pos] = value</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                insort(_lists[pos], value)</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">self</span>._expand(pos)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            _lists.append([value])</span><br><span class="line">            _maxes.append(value)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>._<span class="built_in">len</span> += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_expand</span>(<span class="params">self, pos</span>):</span><br><span class="line"></span><br><span class="line">        _load = <span class="variable language_">self</span>._load</span><br><span class="line">        _lists = <span class="variable language_">self</span>._lists</span><br><span class="line">        _index = <span class="variable language_">self</span>._index</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(_lists[pos]) &gt; (_load &lt;&lt; <span class="number">1</span>):</span><br><span class="line">            _maxes = <span class="variable language_">self</span>._maxes</span><br><span class="line"></span><br><span class="line">            _lists_pos = _lists[pos]</span><br><span class="line">            half = _lists_pos[_load:]</span><br><span class="line">            <span class="keyword">del</span> _lists_pos[_load:]</span><br><span class="line">            _maxes[pos] = _lists_pos[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">            _lists.insert(pos + <span class="number">1</span>, half)</span><br><span class="line">            _maxes.insert(pos + <span class="number">1</span>, half[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">            <span class="keyword">del</span> _index[:]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> _index:</span><br><span class="line">                child = <span class="variable language_">self</span>._offset + pos</span><br><span class="line">                <span class="keyword">while</span> child:</span><br><span class="line">                    _index[child] += <span class="number">1</span></span><br><span class="line">                    child = (child - <span class="number">1</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">                _index[<span class="number">0</span>] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, iterable</span>):</span><br><span class="line"></span><br><span class="line">        _lists = <span class="variable language_">self</span>._lists</span><br><span class="line">        _maxes = <span class="variable language_">self</span>._maxes</span><br><span class="line">        values = <span class="built_in">sorted</span>(iterable)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> _maxes:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(values) * <span class="number">4</span> &gt;= <span class="variable language_">self</span>._<span class="built_in">len</span>:</span><br><span class="line">                _lists.append(values)</span><br><span class="line">                values = reduce(iadd, _lists, [])</span><br><span class="line">                values.sort()</span><br><span class="line">                <span class="variable language_">self</span>._clear()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                _add = <span class="variable language_">self</span>.add</span><br><span class="line">                <span class="keyword">for</span> val <span class="keyword">in</span> values:</span><br><span class="line">                    _add(val)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        _load = <span class="variable language_">self</span>._load</span><br><span class="line">        _lists.extend(values[pos:(pos + _load)]</span><br><span class="line">                      <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(values), _load))</span><br><span class="line">        _maxes.extend(sublist[-<span class="number">1</span>] <span class="keyword">for</span> sublist <span class="keyword">in</span> _lists)</span><br><span class="line">        <span class="variable language_">self</span>._<span class="built_in">len</span> = <span class="built_in">len</span>(values)</span><br><span class="line">        <span class="keyword">del</span> <span class="variable language_">self</span>._index[:]</span><br><span class="line"></span><br><span class="line">    _update = update</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__contains__</span>(<span class="params">self, value</span>):</span><br><span class="line"></span><br><span class="line">        _maxes = <span class="variable language_">self</span>._maxes</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _maxes:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        pos = bisect_left(_maxes, value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pos == <span class="built_in">len</span>(_maxes):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        _lists = <span class="variable language_">self</span>._lists</span><br><span class="line">        idx = bisect_left(_lists[pos], value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> _lists[pos][idx] == value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">discard</span>(<span class="params">self, value</span>):</span><br><span class="line"></span><br><span class="line">        _maxes = <span class="variable language_">self</span>._maxes</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _maxes:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        pos = bisect_left(_maxes, value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pos == <span class="built_in">len</span>(_maxes):</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        _lists = <span class="variable language_">self</span>._lists</span><br><span class="line">        idx = bisect_left(_lists[pos], value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> _lists[pos][idx] == value:</span><br><span class="line">            <span class="variable language_">self</span>._delete(pos, idx)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">remove</span>(<span class="params">self, value</span>):</span><br><span class="line"></span><br><span class="line">        _maxes = <span class="variable language_">self</span>._maxes</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _maxes:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;&#123;0!r&#125; not in list&#x27;</span>.<span class="built_in">format</span>(value))</span><br><span class="line"></span><br><span class="line">        pos = bisect_left(_maxes, value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pos == <span class="built_in">len</span>(_maxes):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;&#123;0!r&#125; not in list&#x27;</span>.<span class="built_in">format</span>(value))</span><br><span class="line"></span><br><span class="line">        _lists = <span class="variable language_">self</span>._lists</span><br><span class="line">        idx = bisect_left(_lists[pos], value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> _lists[pos][idx] == value:</span><br><span class="line">            <span class="variable language_">self</span>._delete(pos, idx)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;&#123;0!r&#125; not in list&#x27;</span>.<span class="built_in">format</span>(value))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_delete</span>(<span class="params">self, pos, idx</span>):</span><br><span class="line"></span><br><span class="line">        _lists = <span class="variable language_">self</span>._lists</span><br><span class="line">        _maxes = <span class="variable language_">self</span>._maxes</span><br><span class="line">        _index = <span class="variable language_">self</span>._index</span><br><span class="line"></span><br><span class="line">        _lists_pos = _lists[pos]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">del</span> _lists_pos[idx]</span><br><span class="line">        <span class="variable language_">self</span>._<span class="built_in">len</span> -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        len_lists_pos = <span class="built_in">len</span>(_lists_pos)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> len_lists_pos &gt; (<span class="variable language_">self</span>._load &gt;&gt; <span class="number">1</span>):</span><br><span class="line">            _maxes[pos] = _lists_pos[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> _index:</span><br><span class="line">                child = <span class="variable language_">self</span>._offset + pos</span><br><span class="line">                <span class="keyword">while</span> child &gt; <span class="number">0</span>:</span><br><span class="line">                    _index[child] -= <span class="number">1</span></span><br><span class="line">                    child = (child - <span class="number">1</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">                _index[<span class="number">0</span>] -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(_lists) &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> pos:</span><br><span class="line">                pos += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            prev = pos - <span class="number">1</span></span><br><span class="line">            _lists[prev].extend(_lists[pos])</span><br><span class="line">            _maxes[prev] = _lists[prev][-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">del</span> _lists[pos]</span><br><span class="line">            <span class="keyword">del</span> _maxes[pos]</span><br><span class="line">            <span class="keyword">del</span> _index[:]</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">self</span>._expand(prev)</span><br><span class="line">        <span class="keyword">elif</span> len_lists_pos:</span><br><span class="line">            _maxes[pos] = _lists_pos[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">del</span> _lists[pos]</span><br><span class="line">            <span class="keyword">del</span> _maxes[pos]</span><br><span class="line">            <span class="keyword">del</span> _index[:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_loc</span>(<span class="params">self, pos, idx</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> pos:</span><br><span class="line">            <span class="keyword">return</span> idx</span><br><span class="line">        _index = <span class="variable language_">self</span>._index</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _index:</span><br><span class="line">            <span class="variable language_">self</span>._build_index()</span><br><span class="line"></span><br><span class="line">        total = <span class="number">0</span></span><br><span class="line">        pos += <span class="variable language_">self</span>._offset</span><br><span class="line">        <span class="keyword">while</span> pos:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> pos &amp; <span class="number">1</span>:</span><br><span class="line">                total += _index[pos - <span class="number">1</span>]</span><br><span class="line">            pos = (pos - <span class="number">1</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> total + idx</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_pos</span>(<span class="params">self, idx</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> idx &lt; <span class="number">0</span>:</span><br><span class="line">            last_len = <span class="built_in">len</span>(<span class="variable language_">self</span>._lists[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (-idx) &lt;= last_len:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">len</span>(<span class="variable language_">self</span>._lists) - <span class="number">1</span>, last_len + idx</span><br><span class="line"></span><br><span class="line">            idx += <span class="variable language_">self</span>._<span class="built_in">len</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> idx &lt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">raise</span> IndexError(<span class="string">&#x27;list index out of range&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> idx &gt;= <span class="variable language_">self</span>._<span class="built_in">len</span>:</span><br><span class="line">            <span class="keyword">raise</span> IndexError(<span class="string">&#x27;list index out of range&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> idx &lt; <span class="built_in">len</span>(<span class="variable language_">self</span>._lists[<span class="number">0</span>]):</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>, idx</span><br><span class="line"></span><br><span class="line">        _index = <span class="variable language_">self</span>._index</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _index:</span><br><span class="line">            <span class="variable language_">self</span>._build_index()</span><br><span class="line"></span><br><span class="line">        pos = <span class="number">0</span></span><br><span class="line">        child = <span class="number">1</span></span><br><span class="line">        len_index = <span class="built_in">len</span>(_index)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> child &lt; len_index:</span><br><span class="line">            index_child = _index[child]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> idx &lt; index_child:</span><br><span class="line">                pos = child</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                idx -= index_child</span><br><span class="line">                pos = child + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            child = (pos &lt;&lt; <span class="number">1</span>) + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (pos - <span class="variable language_">self</span>._offset, idx)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_build_index</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">        row0 = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">len</span>, <span class="variable language_">self</span>._lists))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(row0) == <span class="number">1</span>:</span><br><span class="line">            <span class="variable language_">self</span>._index[:] = row0</span><br><span class="line">            <span class="variable language_">self</span>._offset = <span class="number">0</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        head = <span class="built_in">iter</span>(row0)</span><br><span class="line">        tail = <span class="built_in">iter</span>(head)</span><br><span class="line">        row1 = <span class="built_in">list</span>(starmap(add, <span class="built_in">zip</span>(head, tail)))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(row0) &amp; <span class="number">1</span>:</span><br><span class="line">            row1.append(row0[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(row1) == <span class="number">1</span>:</span><br><span class="line">            <span class="variable language_">self</span>._index[:] = row1 + row0</span><br><span class="line">            <span class="variable language_">self</span>._offset = <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        size = <span class="number">2</span> ** (<span class="built_in">int</span>(log(<span class="built_in">len</span>(row1) - <span class="number">1</span>, <span class="number">2</span>)) + <span class="number">1</span>)</span><br><span class="line">        row1.extend(repeat(<span class="number">0</span>, size - <span class="built_in">len</span>(row1)))</span><br><span class="line">        tree = [row0, row1]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(tree[-<span class="number">1</span>]) &gt; <span class="number">1</span>:</span><br><span class="line">            head = <span class="built_in">iter</span>(tree[-<span class="number">1</span>])</span><br><span class="line">            tail = <span class="built_in">iter</span>(head)</span><br><span class="line">            row = <span class="built_in">list</span>(starmap(add, <span class="built_in">zip</span>(head, tail)))</span><br><span class="line">            tree.append(row)</span><br><span class="line"></span><br><span class="line">        reduce(iadd, <span class="built_in">reversed</span>(tree), <span class="variable language_">self</span>._index)</span><br><span class="line">        <span class="variable language_">self</span>._offset = size * <span class="number">2</span> - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delitem__</span>(<span class="params">self, index</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(index, <span class="built_in">slice</span>):</span><br><span class="line">            start, stop, step = index.indices(<span class="variable language_">self</span>._<span class="built_in">len</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> step == <span class="number">1</span> <span class="keyword">and</span> start &lt; stop:</span><br><span class="line">                <span class="keyword">if</span> start == <span class="number">0</span> <span class="keyword">and</span> stop == <span class="variable language_">self</span>._<span class="built_in">len</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="variable language_">self</span>._clear()</span><br><span class="line">                <span class="keyword">elif</span> <span class="variable language_">self</span>._<span class="built_in">len</span> &lt;= <span class="number">8</span> * (stop - start):</span><br><span class="line">                    values = <span class="variable language_">self</span>._getitem(<span class="built_in">slice</span>(<span class="literal">None</span>, start))</span><br><span class="line">                    <span class="keyword">if</span> stop &lt; <span class="variable language_">self</span>._<span class="built_in">len</span>:</span><br><span class="line">                        values += <span class="variable language_">self</span>._getitem(<span class="built_in">slice</span>(stop, <span class="literal">None</span>))</span><br><span class="line">                    <span class="variable language_">self</span>._clear()</span><br><span class="line">                    <span class="keyword">return</span> <span class="variable language_">self</span>._update(values)</span><br><span class="line"></span><br><span class="line">            indices = <span class="built_in">range</span>(start, stop, step)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> step &gt; <span class="number">0</span>:</span><br><span class="line">                indices = <span class="built_in">reversed</span>(indices)</span><br><span class="line"></span><br><span class="line">            _pos, _delete = <span class="variable language_">self</span>._pos, <span class="variable language_">self</span>._delete</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> index <span class="keyword">in</span> indices:</span><br><span class="line">                pos, idx = _pos(index)</span><br><span class="line">                _delete(pos, idx)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pos, idx = <span class="variable language_">self</span>._pos(index)</span><br><span class="line">            <span class="variable language_">self</span>._delete(pos, idx)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, index</span>):</span><br><span class="line">        _lists = <span class="variable language_">self</span>._lists</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(index, <span class="built_in">slice</span>):</span><br><span class="line">            start, stop, step = index.indices(<span class="variable language_">self</span>._<span class="built_in">len</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> step == <span class="number">1</span> <span class="keyword">and</span> start &lt; stop:</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> start == <span class="number">0</span> <span class="keyword">and</span> stop == <span class="variable language_">self</span>._<span class="built_in">len</span>:</span><br><span class="line">                    <span class="keyword">return</span> reduce(iadd, <span class="variable language_">self</span>._lists, [])</span><br><span class="line"></span><br><span class="line">                start_pos, start_idx = <span class="variable language_">self</span>._pos(start)</span><br><span class="line">                start_list = _lists[start_pos]</span><br><span class="line">                stop_idx = start_idx + stop - start</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(start_list) &gt;= stop_idx:</span><br><span class="line">                    <span class="keyword">return</span> start_list[start_idx:stop_idx]</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> stop == <span class="variable language_">self</span>._<span class="built_in">len</span>:</span><br><span class="line">                    stop_pos = <span class="built_in">len</span>(_lists) - <span class="number">1</span></span><br><span class="line">                    stop_idx = <span class="built_in">len</span>(_lists[stop_pos])</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    stop_pos, stop_idx = <span class="variable language_">self</span>._pos(stop)</span><br><span class="line"></span><br><span class="line">                prefix = _lists[start_pos][start_idx:]</span><br><span class="line">                middle = _lists[(start_pos + <span class="number">1</span>):stop_pos]</span><br><span class="line">                result = reduce(iadd, middle, prefix)</span><br><span class="line">                result += _lists[stop_pos][:stop_idx]</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> step == -<span class="number">1</span> <span class="keyword">and</span> start &gt; stop:</span><br><span class="line">                result = <span class="variable language_">self</span>._getitem(<span class="built_in">slice</span>(stop + <span class="number">1</span>, start + <span class="number">1</span>))</span><br><span class="line">                result.reverse()</span><br><span class="line">                <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">            indices = <span class="built_in">range</span>(start, stop, step)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">list</span>(<span class="variable language_">self</span>._getitem(index) <span class="keyword">for</span> index <span class="keyword">in</span> indices)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>._<span class="built_in">len</span>:</span><br><span class="line">                <span class="keyword">if</span> index == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">return</span> _lists[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">elif</span> index == -<span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">return</span> _lists[-<span class="number">1</span>][-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> IndexError(<span class="string">&#x27;list index out of range&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> &lt;= index &lt; <span class="built_in">len</span>(_lists[<span class="number">0</span>]):</span><br><span class="line">                <span class="keyword">return</span> _lists[<span class="number">0</span>][index]</span><br><span class="line"></span><br><span class="line">            len_last = <span class="built_in">len</span>(_lists[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> -len_last &lt; index &lt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> _lists[-<span class="number">1</span>][len_last + index]</span><br><span class="line"></span><br><span class="line">            pos, idx = <span class="variable language_">self</span>._pos(index)</span><br><span class="line">            <span class="keyword">return</span> _lists[pos][idx]</span><br><span class="line"></span><br><span class="line">    _getitem = __getitem__</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__setitem__</span>(<span class="params">self, index, value</span>):</span><br><span class="line"></span><br><span class="line">        message = <span class="string">&#x27;use ``del sl[index]`` and ``sl.add(value)`` instead&#x27;</span></span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError(message)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iter__</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> chain.from_iterable(<span class="variable language_">self</span>._lists)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reversed__</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> chain.from_iterable(<span class="built_in">map</span>(<span class="built_in">reversed</span>, <span class="built_in">reversed</span>(<span class="variable language_">self</span>._lists)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">reverse</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError(<span class="string">&#x27;use ``reversed(sl)`` instead&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">islice</span>(<span class="params">self, start=<span class="literal">None</span>, stop=<span class="literal">None</span>, reverse=<span class="literal">False</span></span>):</span><br><span class="line"></span><br><span class="line">        _<span class="built_in">len</span> = <span class="variable language_">self</span>._<span class="built_in">len</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _<span class="built_in">len</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">iter</span>(())</span><br><span class="line"></span><br><span class="line">        start, stop, _ = <span class="built_in">slice</span>(start, stop).indices(<span class="variable language_">self</span>._<span class="built_in">len</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> start &gt;= stop:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">iter</span>(())</span><br><span class="line"></span><br><span class="line">        _pos = <span class="variable language_">self</span>._pos</span><br><span class="line"></span><br><span class="line">        min_pos, min_idx = _pos(start)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> stop == _<span class="built_in">len</span>:</span><br><span class="line">            max_pos = <span class="built_in">len</span>(<span class="variable language_">self</span>._lists) - <span class="number">1</span></span><br><span class="line">            max_idx = <span class="built_in">len</span>(<span class="variable language_">self</span>._lists[-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            max_pos, max_idx = _pos(stop)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>._islice(min_pos, min_idx, max_pos, max_idx, reverse)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_islice</span>(<span class="params">self, min_pos, min_idx, max_pos, max_idx, reverse</span>):</span><br><span class="line"></span><br><span class="line">        _lists = <span class="variable language_">self</span>._lists</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> min_pos &gt; max_pos:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">iter</span>(())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> min_pos == max_pos:</span><br><span class="line">            <span class="keyword">if</span> reverse:</span><br><span class="line">                indices = <span class="built_in">reversed</span>(<span class="built_in">range</span>(min_idx, max_idx))</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">map</span>(_lists[min_pos].__getitem__, indices)</span><br><span class="line"></span><br><span class="line">            indices = <span class="built_in">range</span>(min_idx, max_idx)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">map</span>(_lists[min_pos].__getitem__, indices)</span><br><span class="line"></span><br><span class="line">        next_pos = min_pos + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> next_pos == max_pos:</span><br><span class="line">            <span class="keyword">if</span> reverse:</span><br><span class="line">                min_indices = <span class="built_in">range</span>(min_idx, <span class="built_in">len</span>(_lists[min_pos]))</span><br><span class="line">                max_indices = <span class="built_in">range</span>(max_idx)</span><br><span class="line">                <span class="keyword">return</span> chain(</span><br><span class="line">                    <span class="built_in">map</span>(_lists[max_pos].__getitem__, <span class="built_in">reversed</span>(max_indices)),</span><br><span class="line">                    <span class="built_in">map</span>(_lists[min_pos].__getitem__, <span class="built_in">reversed</span>(min_indices)),</span><br><span class="line">                )</span><br><span class="line"></span><br><span class="line">            min_indices = <span class="built_in">range</span>(min_idx, <span class="built_in">len</span>(_lists[min_pos]))</span><br><span class="line">            max_indices = <span class="built_in">range</span>(max_idx)</span><br><span class="line">            <span class="keyword">return</span> chain(</span><br><span class="line">                <span class="built_in">map</span>(_lists[min_pos].__getitem__, min_indices),</span><br><span class="line">                <span class="built_in">map</span>(_lists[max_pos].__getitem__, max_indices),</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> reverse:</span><br><span class="line">            min_indices = <span class="built_in">range</span>(min_idx, <span class="built_in">len</span>(_lists[min_pos]))</span><br><span class="line">            sublist_indices = <span class="built_in">range</span>(next_pos, max_pos)</span><br><span class="line">            sublists = <span class="built_in">map</span>(_lists.__getitem__, <span class="built_in">reversed</span>(sublist_indices))</span><br><span class="line">            max_indices = <span class="built_in">range</span>(max_idx)</span><br><span class="line">            <span class="keyword">return</span> chain(</span><br><span class="line">                <span class="built_in">map</span>(_lists[max_pos].__getitem__, <span class="built_in">reversed</span>(max_indices)),</span><br><span class="line">                chain.from_iterable(<span class="built_in">map</span>(<span class="built_in">reversed</span>, sublists)),</span><br><span class="line">                <span class="built_in">map</span>(_lists[min_pos].__getitem__, <span class="built_in">reversed</span>(min_indices)),</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">        min_indices = <span class="built_in">range</span>(min_idx, <span class="built_in">len</span>(_lists[min_pos]))</span><br><span class="line">        sublist_indices = <span class="built_in">range</span>(next_pos, max_pos)</span><br><span class="line">        sublists = <span class="built_in">map</span>(_lists.__getitem__, sublist_indices)</span><br><span class="line">        max_indices = <span class="built_in">range</span>(max_idx)</span><br><span class="line">        <span class="keyword">return</span> chain(</span><br><span class="line">            <span class="built_in">map</span>(_lists[min_pos].__getitem__, min_indices),</span><br><span class="line">            chain.from_iterable(sublists),</span><br><span class="line">            <span class="built_in">map</span>(_lists[max_pos].__getitem__, max_indices),</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">irange</span>(<span class="params">self, minimum=<span class="literal">None</span>, maximum=<span class="literal">None</span>, inclusive=(<span class="params"><span class="literal">True</span>, <span class="literal">True</span></span>),</span></span><br><span class="line"><span class="params">               reverse=<span class="literal">False</span></span>):</span><br><span class="line"></span><br><span class="line">        _maxes = <span class="variable language_">self</span>._maxes</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _maxes:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">iter</span>(())</span><br><span class="line"></span><br><span class="line">        _lists = <span class="variable language_">self</span>._lists</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> minimum <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            min_pos = <span class="number">0</span></span><br><span class="line">            min_idx = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> inclusive[<span class="number">0</span>]:</span><br><span class="line">                min_pos = bisect_left(_maxes, minimum)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> min_pos == <span class="built_in">len</span>(_maxes):</span><br><span class="line">                    <span class="keyword">return</span> <span class="built_in">iter</span>(())</span><br><span class="line"></span><br><span class="line">                min_idx = bisect_left(_lists[min_pos], minimum)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                min_pos = bisect_right(_maxes, minimum)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> min_pos == <span class="built_in">len</span>(_maxes):</span><br><span class="line">                    <span class="keyword">return</span> <span class="built_in">iter</span>(())</span><br><span class="line"></span><br><span class="line">                min_idx = bisect_right(_lists[min_pos], minimum)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> maximum <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            max_pos = <span class="built_in">len</span>(_maxes) - <span class="number">1</span></span><br><span class="line">            max_idx = <span class="built_in">len</span>(_lists[max_pos])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> inclusive[<span class="number">1</span>]:</span><br><span class="line">                max_pos = bisect_right(_maxes, maximum)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> max_pos == <span class="built_in">len</span>(_maxes):</span><br><span class="line">                    max_pos -= <span class="number">1</span></span><br><span class="line">                    max_idx = <span class="built_in">len</span>(_lists[max_pos])</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    max_idx = bisect_right(_lists[max_pos], maximum)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                max_pos = bisect_left(_maxes, maximum)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> max_pos == <span class="built_in">len</span>(_maxes):</span><br><span class="line">                    max_pos -= <span class="number">1</span></span><br><span class="line">                    max_idx = <span class="built_in">len</span>(_lists[max_pos])</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    max_idx = bisect_left(_lists[max_pos], maximum)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>._islice(min_pos, min_idx, max_pos, max_idx, reverse)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>._<span class="built_in">len</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bisect_left</span>(<span class="params">self, value</span>):</span><br><span class="line"></span><br><span class="line">        _maxes = <span class="variable language_">self</span>._maxes</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _maxes:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        pos = bisect_left(_maxes, value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pos == <span class="built_in">len</span>(_maxes):</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>._<span class="built_in">len</span></span><br><span class="line"></span><br><span class="line">        idx = bisect_left(<span class="variable language_">self</span>._lists[pos], value)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>._loc(pos, idx)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">bisect_right</span>(<span class="params">self, value</span>):</span><br><span class="line"></span><br><span class="line">        _maxes = <span class="variable language_">self</span>._maxes</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _maxes:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        pos = bisect_right(_maxes, value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pos == <span class="built_in">len</span>(_maxes):</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>._<span class="built_in">len</span></span><br><span class="line"></span><br><span class="line">        idx = bisect_right(<span class="variable language_">self</span>._lists[pos], value)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>._loc(pos, idx)</span><br><span class="line"></span><br><span class="line">    bisect = bisect_right</span><br><span class="line">    _bisect_right = bisect_right</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">count</span>(<span class="params">self, value</span>):</span><br><span class="line"></span><br><span class="line">        _maxes = <span class="variable language_">self</span>._maxes</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _maxes:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        pos_left = bisect_left(_maxes, value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pos_left == <span class="built_in">len</span>(_maxes):</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        _lists = <span class="variable language_">self</span>._lists</span><br><span class="line">        idx_left = bisect_left(_lists[pos_left], value)</span><br><span class="line">        pos_right = bisect_right(_maxes, value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pos_right == <span class="built_in">len</span>(_maxes):</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>._<span class="built_in">len</span> - <span class="variable language_">self</span>._loc(pos_left, idx_left)</span><br><span class="line"></span><br><span class="line">        idx_right = bisect_right(_lists[pos_right], value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pos_left == pos_right:</span><br><span class="line">            <span class="keyword">return</span> idx_right - idx_left</span><br><span class="line"></span><br><span class="line">        right = <span class="variable language_">self</span>._loc(pos_right, idx_right)</span><br><span class="line">        left = <span class="variable language_">self</span>._loc(pos_left, idx_left)</span><br><span class="line">        <span class="keyword">return</span> right - left</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">copy</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__class__(<span class="variable language_">self</span>)</span><br><span class="line"></span><br><span class="line">    __copy__ = copy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">append</span>(<span class="params">self, value</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError(<span class="string">&#x27;use ``sl.add(value)`` instead&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extend</span>(<span class="params">self, values</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError(<span class="string">&#x27;use ``sl.update(values)`` instead&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">insert</span>(<span class="params">self, index, value</span>):</span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError(<span class="string">&#x27;use ``sl.add(value)`` instead&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pop</span>(<span class="params">self, index=-<span class="number">1</span></span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>._<span class="built_in">len</span>:</span><br><span class="line">            <span class="keyword">raise</span> IndexError(<span class="string">&#x27;pop index out of range&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        _lists = <span class="variable language_">self</span>._lists</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> index == <span class="number">0</span>:</span><br><span class="line">            val = _lists[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="variable language_">self</span>._delete(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> index == -<span class="number">1</span>:</span><br><span class="line">            pos = <span class="built_in">len</span>(_lists) - <span class="number">1</span></span><br><span class="line">            loc = <span class="built_in">len</span>(_lists[pos]) - <span class="number">1</span></span><br><span class="line">            val = _lists[pos][loc]</span><br><span class="line">            <span class="variable language_">self</span>._delete(pos, loc)</span><br><span class="line">            <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= index &lt; <span class="built_in">len</span>(_lists[<span class="number">0</span>]):</span><br><span class="line">            val = _lists[<span class="number">0</span>][index]</span><br><span class="line">            <span class="variable language_">self</span>._delete(<span class="number">0</span>, index)</span><br><span class="line">            <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line">        len_last = <span class="built_in">len</span>(_lists[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> -len_last &lt; index &lt; <span class="number">0</span>:</span><br><span class="line">            pos = <span class="built_in">len</span>(_lists) - <span class="number">1</span></span><br><span class="line">            loc = len_last + index</span><br><span class="line">            val = _lists[pos][loc]</span><br><span class="line">            <span class="variable language_">self</span>._delete(pos, loc)</span><br><span class="line">            <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line">        pos, idx = <span class="variable language_">self</span>._pos(index)</span><br><span class="line">        val = _lists[pos][idx]</span><br><span class="line">        <span class="variable language_">self</span>._delete(pos, idx)</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">self, value, start=<span class="literal">None</span>, stop=<span class="literal">None</span></span>):</span><br><span class="line"></span><br><span class="line">        _<span class="built_in">len</span> = <span class="variable language_">self</span>._<span class="built_in">len</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _<span class="built_in">len</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;&#123;0!r&#125; is not in list&#x27;</span>.<span class="built_in">format</span>(value))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> start <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            start = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> start &lt; <span class="number">0</span>:</span><br><span class="line">            start += _<span class="built_in">len</span></span><br><span class="line">        <span class="keyword">if</span> start &lt; <span class="number">0</span>:</span><br><span class="line">            start = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> stop <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            stop = _<span class="built_in">len</span></span><br><span class="line">        <span class="keyword">if</span> stop &lt; <span class="number">0</span>:</span><br><span class="line">            stop += _<span class="built_in">len</span></span><br><span class="line">        <span class="keyword">if</span> stop &gt; _<span class="built_in">len</span>:</span><br><span class="line">            stop = _<span class="built_in">len</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> stop &lt;= start:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;&#123;0!r&#125; is not in list&#x27;</span>.<span class="built_in">format</span>(value))</span><br><span class="line"></span><br><span class="line">        _maxes = <span class="variable language_">self</span>._maxes</span><br><span class="line">        pos_left = bisect_left(_maxes, value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pos_left == <span class="built_in">len</span>(_maxes):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;&#123;0!r&#125; is not in list&#x27;</span>.<span class="built_in">format</span>(value))</span><br><span class="line"></span><br><span class="line">        _lists = <span class="variable language_">self</span>._lists</span><br><span class="line">        idx_left = bisect_left(_lists[pos_left], value)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> _lists[pos_left][idx_left] != value:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;&#123;0!r&#125; is not in list&#x27;</span>.<span class="built_in">format</span>(value))</span><br><span class="line"></span><br><span class="line">        stop -= <span class="number">1</span></span><br><span class="line">        left = <span class="variable language_">self</span>._loc(pos_left, idx_left)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> start &lt;= left:</span><br><span class="line">            <span class="keyword">if</span> left &lt;= stop:</span><br><span class="line">                <span class="keyword">return</span> left</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            right = <span class="variable language_">self</span>._bisect_right(value) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> start &lt;= right:</span><br><span class="line">                <span class="keyword">return</span> start</span><br><span class="line"></span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&#x27;&#123;0!r&#125; is not in list&#x27;</span>.<span class="built_in">format</span>(value))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self, other</span>):</span><br><span class="line"></span><br><span class="line">        values = reduce(iadd, <span class="variable language_">self</span>._lists, [])</span><br><span class="line">        values.extend(other)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__class__(values)</span><br><span class="line"></span><br><span class="line">    __radd__ = __add__</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iadd__</span>(<span class="params">self, other</span>):</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>._update(other)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self, num</span>):</span><br><span class="line"></span><br><span class="line">        values = reduce(iadd, <span class="variable language_">self</span>._lists, []) * num</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__class__(values)</span><br><span class="line"></span><br><span class="line">    __rmul__ = __mul__</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__imul__</span>(<span class="params">self, num</span>):</span><br><span class="line"></span><br><span class="line">        values = reduce(iadd, <span class="variable language_">self</span>._lists, []) * num</span><br><span class="line">        <span class="variable language_">self</span>._clear()</span><br><span class="line">        <span class="variable language_">self</span>._update(values)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__make_cmp</span>(<span class="params">seq_op, symbol, doc</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">comparer</span>(<span class="params">self, other</span>):</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(other, <span class="type">Sequence</span>):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">NotImplemented</span></span><br><span class="line"></span><br><span class="line">            self_len = <span class="variable language_">self</span>._<span class="built_in">len</span></span><br><span class="line">            len_other = <span class="built_in">len</span>(other)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> self_len != len_other:</span><br><span class="line">                <span class="keyword">if</span> seq_op <span class="keyword">is</span> eq:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">if</span> seq_op <span class="keyword">is</span> ne:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> alpha, beta <span class="keyword">in</span> <span class="built_in">zip</span>(<span class="variable language_">self</span>, other):</span><br><span class="line">                <span class="keyword">if</span> alpha != beta:</span><br><span class="line">                    <span class="keyword">return</span> seq_op(alpha, beta)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> seq_op(self_len, len_other)</span><br><span class="line"></span><br><span class="line">        seq_op_name = seq_op.__name__</span><br><span class="line">        comparer.__name__ = <span class="string">&#x27;__&#123;0&#125;__&#x27;</span>.<span class="built_in">format</span>(seq_op_name)</span><br><span class="line">        doc_str = <span class="string">&quot;&quot;&quot;Return true if and only if sorted list is &#123;0&#125; `other`.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        ``sl.__&#123;1&#125;__(other)`` &lt;==&gt; ``sl &#123;2&#125; other``</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Comparisons use lexicographical order as with sequences.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Runtime complexity: `O(n)`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :param other: `other` sequence</span></span><br><span class="line"><span class="string">        :return: true if sorted list is &#123;0&#125; `other`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        comparer.__doc__ = dedent(doc_str.<span class="built_in">format</span>(doc, seq_op_name, symbol))</span><br><span class="line">        <span class="keyword">return</span> comparer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    __eq__ = __make_cmp(eq, <span class="string">&#x27;==&#x27;</span>, <span class="string">&#x27;equal to&#x27;</span>)</span><br><span class="line">    __ne__ = __make_cmp(ne, <span class="string">&#x27;!=&#x27;</span>, <span class="string">&#x27;not equal to&#x27;</span>)</span><br><span class="line">    __lt__ = __make_cmp(lt, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;less than&#x27;</span>)</span><br><span class="line">    __gt__ = __make_cmp(gt, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;greater than&#x27;</span>)</span><br><span class="line">    __le__ = __make_cmp(le, <span class="string">&#x27;&lt;=&#x27;</span>, <span class="string">&#x27;less than or equal to&#x27;</span>)</span><br><span class="line">    __ge__ = __make_cmp(ge, <span class="string">&#x27;&gt;=&#x27;</span>, <span class="string">&#x27;greater than or equal to&#x27;</span>)</span><br><span class="line">    __make_cmp = <span class="built_in">staticmethod</span>(__make_cmp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        values = reduce(iadd, <span class="variable language_">self</span>._lists, [])</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">type</span>(<span class="variable language_">self</span>), (values,))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">    @recursive_repr()</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#123;0&#125;(&#123;1!r&#125;)&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">type</span>(<span class="variable language_">self</span>).__name__, <span class="built_in">list</span>(<span class="variable language_">self</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_check</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">assert</span> <span class="variable language_">self</span>._load &gt;= <span class="number">4</span></span><br><span class="line">            <span class="keyword">assert</span> <span class="built_in">len</span>(<span class="variable language_">self</span>._maxes) == <span class="built_in">len</span>(<span class="variable language_">self</span>._lists)</span><br><span class="line">            <span class="keyword">assert</span> <span class="variable language_">self</span>._<span class="built_in">len</span> == <span class="built_in">sum</span>(<span class="built_in">len</span>(sublist) <span class="keyword">for</span> sublist <span class="keyword">in</span> <span class="variable language_">self</span>._lists)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> sublist <span class="keyword">in</span> <span class="variable language_">self</span>._lists:</span><br><span class="line">                <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(sublist)):</span><br><span class="line">                    <span class="keyword">assert</span> sublist[pos - <span class="number">1</span>] &lt;= sublist[pos]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(<span class="variable language_">self</span>._lists)):</span><br><span class="line">                <span class="keyword">assert</span> <span class="variable language_">self</span>._lists[pos - <span class="number">1</span>][-<span class="number">1</span>] &lt;= <span class="variable language_">self</span>._lists[pos][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="variable language_">self</span>._maxes)):</span><br><span class="line">                <span class="keyword">assert</span> <span class="variable language_">self</span>._maxes[pos] == <span class="variable language_">self</span>._lists[pos][-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">            double = <span class="variable language_">self</span>._load &lt;&lt; <span class="number">1</span></span><br><span class="line">            <span class="keyword">assert</span> <span class="built_in">all</span>(<span class="built_in">len</span>(sublist) &lt;= double <span class="keyword">for</span> sublist <span class="keyword">in</span> <span class="variable language_">self</span>._lists)</span><br><span class="line"></span><br><span class="line">            half = <span class="variable language_">self</span>._load &gt;&gt; <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(<span class="variable language_">self</span>._lists) - <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">assert</span> <span class="built_in">len</span>(<span class="variable language_">self</span>._lists[pos]) &gt;= half</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>._index:</span><br><span class="line">                <span class="keyword">assert</span> <span class="variable language_">self</span>._<span class="built_in">len</span> == <span class="variable language_">self</span>._index[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">assert</span> <span class="built_in">len</span>(<span class="variable language_">self</span>._index) == <span class="variable language_">self</span>._offset + <span class="built_in">len</span>(<span class="variable language_">self</span>._lists)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="variable language_">self</span>._lists)):</span><br><span class="line">                    leaf = <span class="variable language_">self</span>._index[<span class="variable language_">self</span>._offset + pos]</span><br><span class="line">                    <span class="keyword">assert</span> leaf == <span class="built_in">len</span>(<span class="variable language_">self</span>._lists[pos])</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>._offset):</span><br><span class="line">                    child = (pos &lt;&lt; <span class="number">1</span>) + <span class="number">1</span></span><br><span class="line">                    <span class="keyword">if</span> child &gt;= <span class="built_in">len</span>(<span class="variable language_">self</span>._index):</span><br><span class="line">                        <span class="keyword">assert</span> <span class="variable language_">self</span>._index[pos] == <span class="number">0</span></span><br><span class="line">                    <span class="keyword">elif</span> child + <span class="number">1</span> == <span class="built_in">len</span>(<span class="variable language_">self</span>._index):</span><br><span class="line">                        <span class="keyword">assert</span> <span class="variable language_">self</span>._index[pos] == <span class="variable language_">self</span>._index[child]</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        child_sum = <span class="variable language_">self</span>._index[child] + <span class="variable language_">self</span>._index[child + <span class="number">1</span>]</span><br><span class="line">                        <span class="keyword">assert</span> child_sum == <span class="variable language_">self</span>._index[pos]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            traceback.print_exc(file=sys.stdout)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;len&#x27;</span>, <span class="variable language_">self</span>._<span class="built_in">len</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;load&#x27;</span>, <span class="variable language_">self</span>._load)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;offset&#x27;</span>, <span class="variable language_">self</span>._offset)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;len_index&#x27;</span>, <span class="built_in">len</span>(<span class="variable language_">self</span>._index))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;index&#x27;</span>, <span class="variable language_">self</span>._index)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;len_maxes&#x27;</span>, <span class="built_in">len</span>(<span class="variable language_">self</span>._maxes))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;maxes&#x27;</span>, <span class="variable language_">self</span>._maxes)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;len_lists&#x27;</span>, <span class="built_in">len</span>(<span class="variable language_">self</span>._lists))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;lists&#x27;</span>, <span class="variable language_">self</span>._lists)</span><br><span class="line">            <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">identity</span>(<span class="params">value</span>):</span><br><span class="line">    <span class="keyword">return</span> value</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://gitee.com/kokoachino/picture-bed/raw/master/%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/head.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://gitee.com/kokoachino/picture-bed/raw/master/%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/head.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">星开祈灵</div><div class="post-copyright__author_desc">( ´•̥̥̥ω•̥̥̥` )</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://kokoachino.github.io/2025/05/15/05%20Python%20%E7%AE%97%E6%B3%95%E6%A8%A1%E7%89%88/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://kokoachino.github.io/2025/05/15/05%20Python%20%E7%AE%97%E6%B3%95%E6%A8%A1%E7%89%88/')">Python 算法模版</span></a></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://KokoaChino.github.io" target="_blank">星开祈灵的个人博客</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Python/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Python<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/%E7%AE%97%E6%B3%95/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>算法<span class="tagsPageCount">2</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/04/18/04%20C++%20%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://gitee.com/kokoachino/picture-bed/raw/master/%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87.jpg?_r_=5c742af9-b7d1-af98-9964-15e0758580fa" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">C++ 语法基础</div></div></a></div><div class="next-post pull-right"><a href="/2025/06/27/06%20Java%20%E7%AE%97%E6%B3%95%E6%A8%A1%E7%89%88/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://gitee.com/kokoachino/picture-bed/raw/master/%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87.jpg?_r_=949c47da-bb76-bd2b-2e64-ca2d083cb70f" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Java 算法模版</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2024/12/05/03%20Python%20%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E5%9F%BA%E7%A1%80/" title="Python 数学建模基础"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://gitee.com/kokoachino/picture-bed/raw/master/%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87.jpg?_r_=3845718d-b398-fd4b-e1ed-05c3918ba169" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-12-05</div><div class="title">Python 数学建模基础</div></div></a></div><div><a href="/2025/06/27/06%20Java%20%E7%AE%97%E6%B3%95%E6%A8%A1%E7%89%88/" title="Java 算法模版"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://gitee.com/kokoachino/picture-bed/raw/master/%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87.jpg?_r_=949c47da-bb76-bd2b-2e64-ca2d083cb70f" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-06-27</div><div class="title">Java 算法模版</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%A8%A1%E7%89%88"><span class="toc-number">1.</span> <span class="toc-text">基础模版</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%A8%A1%E7%89%88"><span class="toc-number">1.0.1.</span> <span class="toc-text">代码模版</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E6%8B%8D%E6%A8%A1%E7%89%88"><span class="toc-number">1.0.2.</span> <span class="toc-text">对拍模版</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%8F%E5%85%B8%E6%A8%A1%E7%89%88"><span class="toc-number">2.</span> <span class="toc-text">经典模版</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E6%96%87%E5%AD%90%E4%B8%B2"><span class="toc-number">2.0.1.</span> <span class="toc-text">回文子串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E6%96%87%E6%95%B0"><span class="toc-number">2.0.2.</span> <span class="toc-text">回文数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%AD%90%E5%BA%8F%E5%88%97"><span class="toc-number">2.0.3.</span> <span class="toc-text">最长公共子序列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97"><span class="toc-number">2.0.4.</span> <span class="toc-text">最长递增子序列</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-number">3.</span> <span class="toc-text">数组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%BC%80%E5%92%8C"><span class="toc-number">3.0.1.</span> <span class="toc-text">前缀和</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%AE%E5%88%86"><span class="toc-number">3.0.2.</span> <span class="toc-text">差分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97%E6%9E%9A%E4%B8%BE%E6%8A%80%E5%B7%A7"><span class="toc-number">3.0.3.</span> <span class="toc-text">位运算枚举技巧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%B0%83%E6%A0%88"><span class="toc-number">3.0.4.</span> <span class="toc-text">单调栈</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97"><span class="toc-number">3.0.5.</span> <span class="toc-text">单调队列</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">4.</span> <span class="toc-text">字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%93%88%E5%B8%8C"><span class="toc-number">4.0.1.</span> <span class="toc-text">字符串哈希</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#KMP"><span class="toc-number">4.0.2.</span> <span class="toc-text">KMP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Z-%E5%87%BD%E6%95%B0"><span class="toc-number">4.0.3.</span> <span class="toc-text">Z 函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E5%85%B8%E6%A0%91"><span class="toc-number">4.0.4.</span> <span class="toc-text">字典树</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%BE%E8%AE%BA"><span class="toc-number">5.</span> <span class="toc-text">图论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dijkstra"><span class="toc-number">5.0.1.</span> <span class="toc-text">Dijkstra</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Floyd"><span class="toc-number">5.0.2.</span> <span class="toc-text">Floyd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F"><span class="toc-number">5.0.3.</span> <span class="toc-text">拓扑排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B6%E6%9F%A5%E9%9B%86"><span class="toc-number">5.0.4.</span> <span class="toc-text">并查集</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92"><span class="toc-number">6.</span> <span class="toc-text">动态规划</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E4%BD%8D-DP"><span class="toc-number">6.0.1.</span> <span class="toc-text">数位 DP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E5%BF%AB%E9%80%9F%E5%B9%82"><span class="toc-number">6.0.2.</span> <span class="toc-text">矩阵快速幂</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E8%AE%BA"><span class="toc-number">7.</span> <span class="toc-text">数论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%A8%E6%95%B0%E7%AD%9B%E9%80%89"><span class="toc-number">7.0.1.</span> <span class="toc-text">质数筛选</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%A8%E5%9B%A0%E6%95%B0%E5%88%86%E8%A7%A3"><span class="toc-number">7.0.2.</span> <span class="toc-text">质因数分解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83"><span class="toc-number">7.0.3.</span> <span class="toc-text">乘法逆元</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">8.</span> <span class="toc-text">高级数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84-Sum"><span class="toc-number">8.0.1.</span> <span class="toc-text">树状数组 Sum</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84-Min"><span class="toc-number">8.0.2.</span> <span class="toc-text">树状数组 Min</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84-Max"><span class="toc-number">8.0.3.</span> <span class="toc-text">树状数组 Max</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%AE%B5%E6%A0%91"><span class="toc-number">8.0.4.</span> <span class="toc-text">线段树</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B3%E8%A1%A1%E6%A0%91"><span class="toc-number">8.0.5.</span> <span class="toc-text">平衡树</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/27/06%20Java%20%E7%AE%97%E6%B3%95%E6%A8%A1%E7%89%88/" title="Java 算法模版">Java 算法模版</a><time datetime="2025-06-26T16:00:00.000Z" title="发表于 2025-06-27 00:00:00">2025-06-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/15/05%20Python%20%E7%AE%97%E6%B3%95%E6%A8%A1%E7%89%88/" title="Python 算法模版">Python 算法模版</a><time datetime="2025-05-14T16:00:00.000Z" title="发表于 2025-05-15 00:00:00">2025-05-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/18/04%20C++%20%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/" title="C++ 语法基础">C++ 语法基础</a><time datetime="2025-04-17T16:00:00.000Z" title="发表于 2025-04-18 00:00:00">2025-04-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/05/03%20Python%20%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E5%9F%BA%E7%A1%80/" title="Python 数学建模基础">Python 数学建模基础</a><time datetime="2024-12-04T16:00:00.000Z" title="发表于 2024-12-05 00:00:00">2024-12-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/16/13%20JavaJUC%20%E5%A4%9A%E7%BA%BF%E7%A8%8B/" title="JavaJUC 多线程">JavaJUC 多线程</a><time datetime="2024-11-15T16:00:00.000Z" title="发表于 2024-11-16 00:00:00">2024-11-16</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 - 2025 By <a class="footer-bar-link" href="/" title="星开祈灵" target="_blank">星开祈灵</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">27</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">131</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">4</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/API/" style="font-size: 0.88rem;">API<sup>1</sup></a><a href="/tags/CSS/" style="font-size: 0.88rem;">CSS<sup>1</sup></a><a href="/tags/Git/" style="font-size: 0.88rem;">Git<sup>1</sup></a><a href="/tags/HTML/" style="font-size: 0.88rem;">HTML<sup>1</sup></a><a href="/tags/Java/" style="font-size: 0.88rem;">Java<sup>8</sup></a><a href="/tags/Lambda/" style="font-size: 0.88rem;">Lambda<sup>1</sup></a><a href="/tags/Matlab/" style="font-size: 0.88rem;">Matlab<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 0.88rem;">MySQL<sup>1</sup></a><a href="/tags/Optional/" style="font-size: 0.88rem;">Optional<sup>1</sup></a><a href="/tags/Stream-%E6%B5%81/" style="font-size: 0.88rem;">Stream 流<sup>1</sup></a><a href="/tags/Web/" style="font-size: 0.88rem;">Web<sup>6</sup></a><a href="/tags/%E4%BA%8B%E5%8A%A1/" style="font-size: 0.88rem;">事务<sup>4</sup></a><a href="/tags/%E5%87%BD%E6%95%B0/" style="font-size: 0.88rem;">函数<sup>4</sup></a><a href="/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3/" style="font-size: 0.88rem;">函数式接口<sup>1</sup></a><a href="/tags/%E5%88%86%E6%94%AF/" style="font-size: 0.88rem;">分支<sup>1</sup></a><a href="/tags/%E5%8F%8D%E5%B0%84/" style="font-size: 0.88rem;">反射<sup>1</sup></a><a href="/tags/%E5%91%BD%E4%BB%A4/" style="font-size: 0.88rem;">命令<sup>2</sup></a><a href="/tags/%E5%9B%BE%E5%83%8F%E7%BB%98%E5%88%B6/" style="font-size: 0.88rem;">图像绘制<sup>1</sup></a><a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 0.88rem;">多线程<sup>1</sup></a><a href="/tags/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B/" style="font-size: 0.88rem;">存储过程<sup>1</sup></a><a href="/tags/%E5%AE%9A%E6%97%B6%E5%99%A8/" style="font-size: 0.88rem;">定时器<sup>2</sup></a><a href="/tags/%E5%B1%9E%E6%80%A7/" style="font-size: 0.88rem;">属性<sup>2</sup></a><a href="/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8/" style="font-size: 0.88rem;">异常处理器<sup>1</sup></a><a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 0.88rem;">数学<sup>2</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 0.88rem;">数据库<sup>2</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" style="font-size: 0.88rem;">数据类型<sup>4</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1%E4%B8%8E%E8%AE%A1%E7%AE%97/" style="font-size: 0.88rem;">数据统计与计算<sup>1</sup></a><a href="/tags/%E6%96%87%E4%BB%B6/" style="font-size: 0.88rem;">文件<sup>1</sup></a><a href="/tags/%E6%96%B0%E7%89%B9%E6%80%A7/" style="font-size: 0.88rem;">新特性<sup>1</sup></a><a href="/tags/%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D/" style="font-size: 0.88rem;">正则匹配<sup>1</sup></a><a href="/tags/%E6%B3%A8%E8%A7%A3/" style="font-size: 0.88rem;">注解<sup>5</sup></a><a href="/tags/%E6%B8%B8%E6%A0%87/" style="font-size: 0.88rem;">游标<sup>1</sup></a><a href="/tags/%E7%AC%A6%E5%8F%B7%E5%AF%B9%E8%B1%A1/" style="font-size: 0.88rem;">符号对象<sup>1</sup></a><a href="/tags/%E7%B4%A2%E5%BC%95/" style="font-size: 0.88rem;">索引<sup>1</sup></a><a href="/tags/%E8%A7%86%E5%9B%BE/" style="font-size: 0.88rem;">视图<sup>1</sup></a><a href="/tags/%E8%A7%A6%E5%8F%91%E5%99%A8/" style="font-size: 0.88rem;">触发器<sup>1</sup></a><a href="/tags/%E8%AF%AD%E6%B3%95/" style="font-size: 0.88rem;">语法<sup>8</sup></a><a href="/tags/%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/" style="font-size: 0.88rem;">远程仓库<sup>1</sup></a><a href="/tags/%E9%80%89%E6%8B%A9%E5%99%A8/" style="font-size: 0.88rem;">选择器<sup>1</sup></a><a href="/tags/%E9%94%81/" style="font-size: 0.88rem;">锁<sup>4</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("11/1/2024 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 星开祈灵 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>